import { Injectable, defineInjectable, inject } from '@angular/core';
import { HttpClient } from '@angular/common/http';
import { of, forkJoin, Observable, throwError } from 'rxjs';
import { tap, catchError, map, switchMap, mergeMap as mergeMap$1 } from 'rxjs/internal/operators';
import { isArray, each } from 'lodash';
import { switchMap as switchMap$1, mergeMap } from 'rxjs/operators';

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes} checked by tsc
 */
class ManifestService {
    /**
     * @param {?} httpClient
     */
    constructor(httpClient) {
        this.httpClient = httpClient;
        this._defaultRootUrl = '../../../';
        this._manifestLoaded = false;
    }
    /**
     * @return {?}
     */
    getManifest() {
        return this._manifestLoaded ? of(this._manifest) : this.httpClient.get('manifest.webapp').pipe(catchError(() => {
            console.warn('Manifest file could not be loaded, default options have been used instead');
            return of(null);
        }), tap((manifest) => {
            this._manifest = manifest;
            this._manifestLoaded = true;
        }));
    }
    /**
     * @return {?}
     */
    getRootUrl() {
        return this.getManifest().pipe(map((manifest) => {
            if (!manifest) {
                return this._defaultRootUrl;
            }
            return manifest.activities && manifest.activities.dhis && manifest.activities.dhis.href ?
                manifest.activities.dhis.href : this._defaultRootUrl;
        }));
    }
}
ManifestService.decorators = [
    { type: Injectable, args: [{ providedIn: 'root' },] },
];
/** @nocollapse */
ManifestService.ctorParameters = () => [
    { type: HttpClient }
];
/** @nocollapse */ ManifestService.ngInjectableDef = defineInjectable({ factory: function ManifestService_Factory() { return new ManifestService(inject(HttpClient)); }, token: ManifestService, providedIn: "root" });

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes} checked by tsc
 */
class SystemInfoService {
    /**
     * @param {?} manifestService
     * @param {?} httpClient
     */
    constructor(manifestService, httpClient) {
        this.manifestService = manifestService;
        this.httpClient = httpClient;
        this._systemInfoLoaded = false;
    }
    /**
     * @return {?}
     */
    getSystemInfo() {
        return this._systemInfoLoaded ? of(this._systemInfo) :
            this.manifestService.getRootUrl().pipe(switchMap((rootUrl) => forkJoin(this.httpClient.get(`${rootUrl}api/system/info`), this.httpClient.get(`${rootUrl}api/systemSettings`)).pipe(map((res) => {
                return Object.assign({}, res[0], res[1]);
            }), tap((systemInfo) => {
                this._systemInfo = systemInfo;
                this._systemInfoLoaded = true;
            }))));
    }
    /**
     * @return {?}
     */
    getSystemVersion() {
        return this.getSystemInfo().pipe(map((systemInfo) => {
            if (!systemInfo) {
                return 0;
            }
            const /** @type {?} */ splitedVersion = systemInfo.version ? systemInfo.version.split('.') : [];
            return parseInt(splitedVersion[1], 10) || 0;
        }));
    }
}
SystemInfoService.decorators = [
    { type: Injectable, args: [{ providedIn: 'root' },] },
];
/** @nocollapse */
SystemInfoService.ctorParameters = () => [
    { type: ManifestService },
    { type: HttpClient }
];
/** @nocollapse */ SystemInfoService.ngInjectableDef = defineInjectable({ factory: function SystemInfoService_Factory() { return new SystemInfoService(inject(ManifestService), inject(HttpClient)); }, token: SystemInfoService, providedIn: "root" });

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes} checked by tsc
 */
const /** @type {?} */ HTTP_CONFIG = {
    includeVersionNumber: false,
    preferPreviousApiVersion: false,
    useRootUrl: false,
    useIndexDb: false,
    isExternalLink: false
};

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes} checked by tsc
 */
class IndexDbService {
    constructor() {
        this._indexedDB = indexedDB;
        this._dbName = 'db'; // by default
    }
    /**
     * @param {?} dbName
     * @return {?}
     */
    setName(dbName) {
        if (dbName) {
            this._dbName = dbName;
        }
    }
    /**
     * Function to update existing data in the db
     * @param {?} schema
     * @param {?} data
     * @return {?}
     */
    put(schema, data) {
        return Observable.create((observer) => {
            this.create(schema)
                .pipe(switchMap$1(() => this.open()))
                .subscribe((db) => {
                const /** @type {?} */ transaction = db.transaction(schema.name, 'readwrite');
                const /** @type {?} */ store = transaction.objectStore(schema.name);
                if (isArray(data)) {
                    each(data, dataItem => {
                        store.put(dataItem);
                    });
                }
                else {
                    store.put(data);
                }
                transaction.oncomplete = () => {
                    observer.next(data);
                    db.close();
                    observer.complete();
                };
                db.onerror = (errorEvent) => {
                    db.close();
                    observer.error(errorEvent.target.errorCode);
                };
            });
        });
    }
    /**
     * Function to add new data in the db
     * @param {?} schema
     * @param {?} data
     * @return {?}
     */
    post(schema, data) {
        return Observable.create((observer) => {
            this.create(schema)
                .pipe(mergeMap(() => this.open()))
                .subscribe((db) => {
                const /** @type {?} */ transaction = db.transaction(schema.name, 'readwrite');
                const /** @type {?} */ store = transaction.objectStore(schema.name);
                // Check if data is array or an object
                if (isArray(data)) {
                    each(data, dataItem => {
                        store.add(dataItem);
                    });
                }
                else {
                    store.add(data);
                }
                transaction.oncomplete = () => {
                    observer.next(data);
                    db.close();
                    observer.complete();
                };
                db.onerror = () => {
                    observer.next(data);
                    db.close();
                    observer.complete();
                };
            });
        });
    }
    /**
     * Function to get value for a particular key from the table
     * @param {?} schema
     * @param {?} key
     * @return {?}
     */
    findOne(schema, key) {
        return new Observable((observer) => {
            this.create(schema)
                .pipe(mergeMap(() => this.open()))
                .subscribe((db) => {
                const /** @type {?} */ transaction = db.transaction(schema.name, 'readwrite');
                const /** @type {?} */ store = transaction.objectStore(schema.name);
                const /** @type {?} */ request = store.get(key);
                request.onsuccess = successEvent => {
                    observer.next(successEvent.target.result);
                    db.close();
                    observer.complete();
                };
                db.onerror = (event) => {
                    console.log(event.target.errorCode);
                    db.close();
                    observer.error(event.target.errorCode);
                };
            });
        });
    }
    /**
     * Function to find all values for a particular table in the db
     * @param {?} schema
     * @return {?}
     */
    findAll(schema) {
        return Observable.create((observer) => {
            this.create(schema)
                .pipe(switchMap$1(() => this.open()))
                .subscribe((db) => {
                const /** @type {?} */ transaction = db.transaction(schema.name, 'readwrite');
                const /** @type {?} */ store = transaction.objectStore(schema.name);
                const /** @type {?} */ storeIndex = store.index(schema.keyPath);
                const /** @type {?} */ request = storeIndex.openCursor();
                let /** @type {?} */ results = [];
                request.onsuccess = successEvent => {
                    const /** @type {?} */ cursor = successEvent.target.result;
                    if (cursor) {
                        results = [...results, cursor.value];
                        cursor.continue();
                    }
                    else {
                        observer.next(results);
                        db.close();
                        observer.complete();
                    }
                };
                db.onerror = (event) => {
                    db.close();
                    observer.error(event.target.errorCode);
                };
            });
        });
    }
    /**
     * Delete data from the db
     * @param {?} schema
     * @param {?} key
     * @return {?}
     */
    delete(schema, key) {
        return Observable.create((observer) => {
            this.open().subscribe((db) => {
                if (!db.objectStoreNames.contains(schema.name)) {
                    const /** @type {?} */ transaction = db.transaction(schema.name, 'readwrite');
                    const /** @type {?} */ store = transaction.objectStore(schema.name);
                    if (isArray(key)) {
                        each(key, keyItem => {
                            store.delete(keyItem);
                        });
                    }
                    else {
                        store.delete(key);
                    }
                    transaction.oncomplete = () => {
                        observer.next(key);
                        db.close();
                        observer.complete();
                    };
                    db.onerror = (errorEvent) => {
                        db.close();
                        observer.error(errorEvent.target.errorCode);
                    };
                }
            });
        });
    }
    /**
     * Create a schema/table
     * @param {?} schema
     * @return {?}
     */
    create(schema) {
        return Observable.create((observer) => {
            this.open().subscribe((requestResult) => {
                if (!requestResult.objectStoreNames.contains(schema.name)) {
                    /**
                               * Close database to allow opening with new version
                               */
                    requestResult.close();
                    /**
                     * Set a new connection with new version to allows creating schema
                     */
                    const /** @type {?} */ request = this._indexedDB.open(this._dbName, requestResult.version + 1);
                    request.onupgradeneeded = event => {
                        const /** @type {?} */ db = event.target.result;
                        if (!db.objectStoreNames.contains(schema.name)) {
                            /**
                             * Create corresponding schema
                             */
                            const /** @type {?} */ store = db.createObjectStore(schema.name, {
                                keyPath: schema.keyPath
                            });
                            store.createIndex(schema.keyPath, schema.keyPath, {
                                unique: true
                            });
                            /**
                                           * Create indexes for schema if supplied
                                           */
                            if (schema.indexes) {
                                each(schema.indexes, (schemaIndex) => {
                                    store.createIndex(schemaIndex, schemaIndex);
                                });
                            }
                            /**
                                           * Add data if supplied
                                           */
                            if (schema.data) {
                                each(schema.data, (dataItem) => {
                                    store.put(dataItem);
                                });
                            }
                        }
                        observer.next('done');
                        observer.complete();
                    };
                    request.onerror = errorEvent => {
                        observer.error(errorEvent.target.errorCode);
                    };
                    request.onsuccess = successEvent => {
                        successEvent.target.result.close();
                        observer.next('done');
                        observer.complete();
                    };
                }
                else {
                    observer.next('done');
                    observer.complete();
                }
            });
        });
    }
    /**
     * Delete the whole database
     * @return {?}
     */
    clear() {
        return Observable.create((observer) => {
            const /** @type {?} */ request = this._indexedDB.deleteDatabase(this._dbName);
            request.onsuccess = () => {
                observer.next('done');
                observer.complete();
            };
            request.onerror = errorEvent => {
                observer.error(errorEvent.target.errorCode);
            };
            request.onblocked = blockEvent => {
                observer.error(blockEvent.target.errorCode);
            };
        });
    }
    /**
     * @return {?}
     */
    open() {
        return Observable.create((observer) => {
            const /** @type {?} */ request = this._indexedDB.open(this._dbName);
            request.onsuccess = successEvent => {
                observer.next(successEvent.target.result);
                observer.complete();
            };
            request.onerror = errorEvent => observer.error(errorEvent.target.errorCode);
        });
    }
}
IndexDbService.decorators = [
    { type: Injectable, args: [{ providedIn: 'root' },] },
];
/** @nocollapse */
IndexDbService.ctorParameters = () => [];
/** @nocollapse */ IndexDbService.ngInjectableDef = defineInjectable({ factory: function IndexDbService_Factory() { return new IndexDbService(); }, token: IndexDbService, providedIn: "root" });

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes} checked by tsc
 */
class NgxDhis2HttpClientService {
    /**
     * @param {?} httpClient
     * @param {?} manifestService
     * @param {?} systemInfoService
     * @param {?} indexDbService
     */
    constructor(httpClient, manifestService, systemInfoService, indexDbService) {
        this.httpClient = httpClient;
        this.manifestService = manifestService;
        this.systemInfoService = systemInfoService;
        this.indexDbService = indexDbService;
    }
    /**
     * @param {?} url
     * @param {?=} httpConfig
     * @return {?}
     */
    get(url, httpConfig) {
        const /** @type {?} */ newHttpConfig = Object.assign({}, HTTP_CONFIG, httpConfig);
        // Make a call directly from url if is external one
        if (newHttpConfig.isExternalLink) {
            return this.httpClient.get(url);
        }
        // load from index db
        if (newHttpConfig.useIndexDb) {
            return this._fetchFromIndexDb(newHttpConfig).pipe(mergeMap$1((indexDbResponse) => indexDbResponse
                ? of(indexDbResponse)
                : this._get(url, newHttpConfig).pipe(mergeMap$1((response) => this._updateIndexDb(newHttpConfig, response)))));
        }
        return this._get(url, newHttpConfig);
    }
    /**
     * @param {?} url
     * @param {?} data
     * @param {?=} httpConfig
     * @return {?}
     */
    post(url, data, httpConfig) {
        const /** @type {?} */ newHttpConfig = Object.assign({}, HTTP_CONFIG, httpConfig);
        return this._getSanitizedRootUrl(newHttpConfig).pipe(mergeMap$1(rootUrl => this.httpClient
            .post(rootUrl + url, data)
            .pipe(mergeMap$1((response) => {
            const /** @type {?} */ dataId = response.uid;
            return newHttpConfig.useIndexDb
                ? dataId
                    ? this._updateIndexDb(newHttpConfig, Object.assign({}, data, { id: dataId }), 'CREATE').pipe(map(() => response))
                    : of(response)
                : of(response);
        }))
            .pipe(catchError(this._handleError))), catchError(this._handleError));
    }
    /**
     * @param {?} url
     * @param {?} data
     * @param {?=} httpConfig
     * @return {?}
     */
    put(url, data, httpConfig) {
        const /** @type {?} */ newHttpConfig = Object.assign({}, HTTP_CONFIG, httpConfig);
        return this._getSanitizedRootUrl(newHttpConfig).pipe(mergeMap$1(rootUrl => this.httpClient.put(rootUrl + url, data).pipe(mergeMap$1((response) => newHttpConfig.useIndexDb
            ? this._updateIndexDb(newHttpConfig, data, 'UPDATE').pipe(map(() => response))
            : of(response)), catchError(this._handleError))), catchError(this._handleError));
    }
    /**
     * @param {?} url
     * @param {?=} httpConfig
     * @return {?}
     */
    delete(url, httpConfig) {
        const /** @type {?} */ newHttpConfig = Object.assign({}, HTTP_CONFIG, httpConfig);
        return this._getSanitizedRootUrl(newHttpConfig).pipe(mergeMap$1(rootUrl => this.httpClient
            .delete(rootUrl + url)
            .pipe(mergeMap$1((response) => newHttpConfig.useIndexDb
            ? this._updateIndexDb(newHttpConfig, null, 'DELETE').pipe(map(() => response))
            : of(response)))
            .pipe(catchError(this._handleError))), catchError(this._handleError));
    }
    /**
     * @param {?} url
     * @param {?} httpConfig
     * @return {?}
     */
    _get(url, httpConfig) {
        return this._getSanitizedRootUrl(httpConfig).pipe(mergeMap$1(rootUrl => this.httpClient.get(rootUrl + url).pipe(catchError(this._handleError))), catchError(this._handleError));
    }
    /**
     * @param {?} err
     * @return {?}
     */
    _handleError(err) {
        let /** @type {?} */ error = null;
        if (err.error instanceof ErrorEvent) {
            // A client-side or network error occurred. Handle it accordingly.
            error = {
                message: err.error,
                status: err.status,
                statusText: err.statusText
            };
        }
        else {
            // The backend returned an unsuccessful response code.
            // The response body may contain clues as to what went wrong,
            error = {
                message: err.error instanceof Object
                    ? err.error.message
                    : err.error || err.message,
                status: err.status,
                statusText: err.statusText
            };
        }
        return throwError(error);
    }
    /**
     * @param {?} httpConfig
     * @return {?}
     */
    _getSanitizedRootUrl(httpConfig) {
        return httpConfig.useRootUrl
            ? this.manifestService.getRootUrl()
            : this._getApiRootUrl(httpConfig.includeVersionNumber, httpConfig.preferPreviousApiVersion);
    }
    /**
     * @param {?=} includeVersionNumber
     * @param {?=} preferPreviousVersion
     * @return {?}
     */
    _getApiRootUrl(includeVersionNumber = false, preferPreviousVersion = false) {
        const /** @type {?} */ rootUrlPromise = this.manifestService.getRootUrl().pipe(switchMap(rootUrl => this.systemInfoService.getSystemVersion().pipe(map((version) => {
            return {
                rootUrl,
                version: version - 1 <= 25 ? version + 1 : version
            };
        }))));
        return rootUrlPromise.pipe(map((urlInfo) => `${urlInfo.rootUrl}api/${includeVersionNumber && !preferPreviousVersion
            ? urlInfo.version + '/'
            : preferPreviousVersion
                ? urlInfo.version
                    ? urlInfo.version - 1 + '/'
                    : ''
                : ''}`));
    }
    /**
     * @param {?} httpConfig
     * @param {?} requestData
     * @param {?=} action
     * @return {?}
     */
    _updateIndexDb(httpConfig, requestData, action = 'CREATE') {
        const /** @type {?} */ indexDbSchema = httpConfig.indexDbConfig
            ? httpConfig.indexDbConfig.schema
            : null;
        const /** @type {?} */ arrayKey = httpConfig.indexDbConfig
            ? httpConfig.indexDbConfig.arrayKey
            : null;
        const /** @type {?} */ indexDbKey = httpConfig.indexDbConfig
            ? httpConfig.indexDbConfig.key
            : null;
        const /** @type {?} */ data = arrayKey ? requestData[arrayKey] : requestData;
        switch (action) {
            case 'CREATE':
            case 'UPDATE':
                return (action === 'CREATE'
                    ? this.indexDbService.post(indexDbSchema, data)
                    : this.indexDbService.put(indexDbSchema, data)).pipe(map(() => requestData), catchError(e => {
                    console.warn('Could not save data into index DB, ERROR: ' + e);
                    return of(requestData);
                }));
            case 'DELETE':
                return this.indexDbService.delete(indexDbSchema, indexDbKey).pipe(map(() => requestData), catchError(e => {
                    console.warn('Could not delete data from index DB, ERROR: ' + e);
                    return of(requestData);
                }));
            default:
                console.log('No action has been specified');
                return of(requestData);
        }
    }
    /**
     * @param {?} httpConfig
     * @return {?}
     */
    _fetchFromIndexDb(httpConfig) {
        const /** @type {?} */ indexDbSchema = httpConfig.indexDbConfig
            ? httpConfig.indexDbConfig.schema
            : null;
        const /** @type {?} */ indexDbKey = httpConfig.indexDbConfig
            ? httpConfig.indexDbConfig.key
            : null;
        return indexDbKey
            ? this.indexDbService.findOne(indexDbSchema, indexDbKey)
            : this.indexDbService.findAll(indexDbSchema).pipe(map(response => {
                const /** @type {?} */ arrayKey = httpConfig.indexDbConfig
                    ? httpConfig.indexDbConfig.arrayKey
                    : null;
                return response.length > 0
                    ? arrayKey
                        ? { [arrayKey]: response }
                        : response
                    : null;
            }));
    }
}
NgxDhis2HttpClientService.decorators = [
    { type: Injectable, args: [{ providedIn: 'root' },] },
];
/** @nocollapse */
NgxDhis2HttpClientService.ctorParameters = () => [
    { type: HttpClient },
    { type: ManifestService },
    { type: SystemInfoService },
    { type: IndexDbService }
];
/** @nocollapse */ NgxDhis2HttpClientService.ngInjectableDef = defineInjectable({ factory: function NgxDhis2HttpClientService_Factory() { return new NgxDhis2HttpClientService(inject(HttpClient), inject(ManifestService), inject(SystemInfoService), inject(IndexDbService)); }, token: NgxDhis2HttpClientService, providedIn: "root" });

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes} checked by tsc
 */

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes} checked by tsc
 */

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes} checked by tsc
 */

export { ManifestService, SystemInfoService, NgxDhis2HttpClientService, IndexDbService };

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaWFwcHMtbmd4LWRoaXMyLWh0dHAtY2xpZW50LmpzLm1hcCIsInNvdXJjZXMiOlsibmc6Ly9AaWFwcHMvbmd4LWRoaXMyLWh0dHAtY2xpZW50L2xpYi9zZXJ2aWNlcy9tYW5pZmVzdC5zZXJ2aWNlLnRzIiwibmc6Ly9AaWFwcHMvbmd4LWRoaXMyLWh0dHAtY2xpZW50L2xpYi9zZXJ2aWNlcy9zeXN0ZW0taW5mby5zZXJ2aWNlLnRzIiwibmc6Ly9AaWFwcHMvbmd4LWRoaXMyLWh0dHAtY2xpZW50L2xpYi9jb25zdGFudHMvaHR0cC1jb25maWcuY29uc3RhbnQudHMiLCJuZzovL0BpYXBwcy9uZ3gtZGhpczItaHR0cC1jbGllbnQvbGliL3NlcnZpY2VzL2luZGV4LWRiLnNlcnZpY2UudHMiLCJuZzovL0BpYXBwcy9uZ3gtZGhpczItaHR0cC1jbGllbnQvbGliL3NlcnZpY2VzL25neC1kaGlzMi1odHRwLWNsaWVudC5zZXJ2aWNlLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEluamVjdGFibGUgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IEh0dHBDbGllbnQgfSBmcm9tICdAYW5ndWxhci9jb21tb24vaHR0cCc7XG5pbXBvcnQgeyBNYW5pZmVzdCB9IGZyb20gJy4uL21vZGVscyc7XG5pbXBvcnQgeyBPYnNlcnZhYmxlLCBvZiB9IGZyb20gJ3J4anMnO1xuaW1wb3J0IHsgdGFwLCBjYXRjaEVycm9yLCBtYXAgfSBmcm9tICdyeGpzL2ludGVybmFsL29wZXJhdG9ycyc7XG5cbkBJbmplY3RhYmxlKHtwcm92aWRlZEluOiAncm9vdCd9KVxuZXhwb3J0IGNsYXNzIE1hbmlmZXN0U2VydmljZSB7XG4gIHByaXZhdGUgX21hbmlmZXN0OiBNYW5pZmVzdDtcbiAgcHJpdmF0ZSBfZGVmYXVsdFJvb3RVcmw6IHN0cmluZztcbiAgcHJpdmF0ZSBfbWFuaWZlc3RMb2FkZWQ6IGJvb2xlYW47XG5cbiAgY29uc3RydWN0b3IocHJpdmF0ZSBodHRwQ2xpZW50OiBIdHRwQ2xpZW50KSB7XG4gICAgdGhpcy5fZGVmYXVsdFJvb3RVcmwgPSAnLi4vLi4vLi4vJztcbiAgICB0aGlzLl9tYW5pZmVzdExvYWRlZCA9IGZhbHNlO1xuICB9XG5cbiAgcHVibGljIGdldE1hbmlmZXN0KCk6IE9ic2VydmFibGU8TWFuaWZlc3Q+IHtcbiAgICByZXR1cm4gdGhpcy5fbWFuaWZlc3RMb2FkZWQgPyBvZih0aGlzLl9tYW5pZmVzdCkgOiB0aGlzLmh0dHBDbGllbnQuZ2V0PE1hbmlmZXN0PignbWFuaWZlc3Qud2ViYXBwJykucGlwZShcbiAgICAgIGNhdGNoRXJyb3IoKCkgPT4ge1xuICAgICAgICBjb25zb2xlLndhcm4oJ01hbmlmZXN0IGZpbGUgY291bGQgbm90IGJlIGxvYWRlZCwgZGVmYXVsdCBvcHRpb25zIGhhdmUgYmVlbiB1c2VkIGluc3RlYWQnKTtcbiAgICAgICAgcmV0dXJuIG9mKG51bGwpO1xuICAgICAgfSksXG4gICAgICB0YXAoKG1hbmlmZXN0KSA9PiB7XG4gICAgICAgIHRoaXMuX21hbmlmZXN0ID0gbWFuaWZlc3Q7XG4gICAgICAgIHRoaXMuX21hbmlmZXN0TG9hZGVkID0gdHJ1ZTtcbiAgICAgIH0pKTtcbiAgfVxuXG4gIHB1YmxpYyBnZXRSb290VXJsKCk6IE9ic2VydmFibGU8c3RyaW5nPiB7XG4gICAgcmV0dXJuIHRoaXMuZ2V0TWFuaWZlc3QoKS5waXBlKG1hcCgobWFuaWZlc3Q6IE1hbmlmZXN0KSA9PiB7XG4gICAgICBpZiAoIW1hbmlmZXN0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9kZWZhdWx0Um9vdFVybDtcbiAgICAgIH1cbiAgICAgIHJldHVybiBtYW5pZmVzdC5hY3Rpdml0aWVzICYmIG1hbmlmZXN0LmFjdGl2aXRpZXMuZGhpcyAmJiBtYW5pZmVzdC5hY3Rpdml0aWVzLmRoaXMuaHJlZiA/XG4gICAgICAgIG1hbmlmZXN0LmFjdGl2aXRpZXMuZGhpcy5ocmVmIDogdGhpcy5fZGVmYXVsdFJvb3RVcmw7XG4gICAgfSkpO1xuICB9XG59XG4iLCJpbXBvcnQgeyBJbmplY3RhYmxlIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBmb3JrSm9pbiwgT2JzZXJ2YWJsZSwgb2YgfSBmcm9tICdyeGpzJztcbmltcG9ydCB7IE1hbmlmZXN0U2VydmljZSB9IGZyb20gJy4vbWFuaWZlc3Quc2VydmljZSc7XG5pbXBvcnQgeyBtYXAsIHN3aXRjaE1hcCwgdGFwIH0gZnJvbSAncnhqcy9pbnRlcm5hbC9vcGVyYXRvcnMnO1xuaW1wb3J0IHsgSHR0cENsaWVudCB9IGZyb20gJ0Bhbmd1bGFyL2NvbW1vbi9odHRwJztcblxuQEluamVjdGFibGUoe3Byb3ZpZGVkSW46ICdyb290J30pXG5leHBvcnQgY2xhc3MgU3lzdGVtSW5mb1NlcnZpY2Uge1xuICBwcml2YXRlIF9zeXN0ZW1JbmZvTG9hZGVkOiBib29sZWFuO1xuICBwcml2YXRlIF9zeXN0ZW1JbmZvOiBhbnk7XG5cbiAgY29uc3RydWN0b3IocHJpdmF0ZSBtYW5pZmVzdFNlcnZpY2U6IE1hbmlmZXN0U2VydmljZSwgcHJpdmF0ZSBodHRwQ2xpZW50OiBIdHRwQ2xpZW50KSB7XG4gICAgdGhpcy5fc3lzdGVtSW5mb0xvYWRlZCA9IGZhbHNlO1xuICB9XG5cbiAgZ2V0U3lzdGVtSW5mbygpOiBPYnNlcnZhYmxlPGFueT4ge1xuICAgIHJldHVybiB0aGlzLl9zeXN0ZW1JbmZvTG9hZGVkID8gb2YodGhpcy5fc3lzdGVtSW5mbykgOlxuICAgICAgdGhpcy5tYW5pZmVzdFNlcnZpY2UuZ2V0Um9vdFVybCgpLnBpcGUoXG4gICAgICAgIHN3aXRjaE1hcCgocm9vdFVybDogc3RyaW5nKSA9PiBmb3JrSm9pbih0aGlzLmh0dHBDbGllbnQuZ2V0KGAke3Jvb3RVcmx9YXBpL3N5c3RlbS9pbmZvYCksXG4gICAgICAgICAgdGhpcy5odHRwQ2xpZW50LmdldChgJHtyb290VXJsfWFwaS9zeXN0ZW1TZXR0aW5nc2ApKS5waXBlKG1hcCgocmVzOiBhbnlbXSkgPT4ge1xuICAgICAgICAgIHJldHVybiB7Li4ucmVzWzBdLCAuLi5yZXNbMV19O1xuICAgICAgICB9KSwgdGFwKChzeXN0ZW1JbmZvOiBhbnkpID0+IHtcbiAgICAgICAgICB0aGlzLl9zeXN0ZW1JbmZvID0gc3lzdGVtSW5mbztcbiAgICAgICAgICB0aGlzLl9zeXN0ZW1JbmZvTG9hZGVkID0gdHJ1ZTtcbiAgICAgICAgfSkpKSk7XG4gIH1cblxuICBwdWJsaWMgZ2V0U3lzdGVtVmVyc2lvbigpOiBPYnNlcnZhYmxlPG51bWJlcj4ge1xuICAgIHJldHVybiB0aGlzLmdldFN5c3RlbUluZm8oKS5waXBlKG1hcCgoc3lzdGVtSW5mbzogYW55KSA9PiB7XG4gICAgICBpZiAoIXN5c3RlbUluZm8pIHtcbiAgICAgICAgcmV0dXJuIDA7XG4gICAgICB9XG4gICAgICBjb25zdCBzcGxpdGVkVmVyc2lvbiA9IHN5c3RlbUluZm8udmVyc2lvbiA/IHN5c3RlbUluZm8udmVyc2lvbi5zcGxpdCgnLicpIDogW107XG4gICAgICByZXR1cm4gcGFyc2VJbnQoc3BsaXRlZFZlcnNpb25bMV0sIDEwKSB8fCAwO1xuICAgIH0pKTtcbiAgfVxufVxuIiwiaW1wb3J0IHsgSHR0cENvbmZpZyB9IGZyb20gJy4uL21vZGVscy9odHRwLWNvbmZpZy5tb2RlbCc7XG5cbmV4cG9ydCBjb25zdCBIVFRQX0NPTkZJRzogSHR0cENvbmZpZyA9IHtcbiAgaW5jbHVkZVZlcnNpb25OdW1iZXI6IGZhbHNlLFxuICBwcmVmZXJQcmV2aW91c0FwaVZlcnNpb246IGZhbHNlLFxuICB1c2VSb290VXJsOiBmYWxzZSxcbiAgdXNlSW5kZXhEYjogZmFsc2UsXG4gIGlzRXh0ZXJuYWxMaW5rOiBmYWxzZVxufTtcbiIsImltcG9ydCB7IEluamVjdGFibGUgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IE9ic2VydmFibGUgfSBmcm9tICdyeGpzJztcbmltcG9ydCAqIGFzIF8gZnJvbSAnbG9kYXNoJztcbmltcG9ydCB7IHN3aXRjaE1hcCwgbWVyZ2VNYXAsIHRhcCB9IGZyb20gJ3J4anMvb3BlcmF0b3JzJztcblxuQEluamVjdGFibGUoeyBwcm92aWRlZEluOiAncm9vdCcgfSlcbmV4cG9ydCBjbGFzcyBJbmRleERiU2VydmljZSB7XG4gIHByaXZhdGUgX2luZGV4ZWREQjogYW55O1xuICBwcml2YXRlIF9kYk5hbWU6IHN0cmluZztcblxuICBjb25zdHJ1Y3RvcigpIHtcbiAgICB0aGlzLl9pbmRleGVkREIgPSBpbmRleGVkREI7XG4gICAgdGhpcy5fZGJOYW1lID0gJ2RiJzsgLy8gYnkgZGVmYXVsdFxuICB9XG5cbiAgc2V0TmFtZShkYk5hbWU6IHN0cmluZyk6IHZvaWQge1xuICAgIGlmIChkYk5hbWUpIHtcbiAgICAgIHRoaXMuX2RiTmFtZSA9IGRiTmFtZTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogRnVuY3Rpb24gdG8gdXBkYXRlIGV4aXN0aW5nIGRhdGEgaW4gdGhlIGRiXG4gICAqL1xuICBwdXQoc2NoZW1hOiBhbnksIGRhdGE6IGFueSk6IE9ic2VydmFibGU8YW55PiB7XG4gICAgcmV0dXJuIE9ic2VydmFibGUuY3JlYXRlKChvYnNlcnZlcjogYW55KSA9PiB7XG4gICAgICB0aGlzLmNyZWF0ZShzY2hlbWEpXG4gICAgICAgIC5waXBlKHN3aXRjaE1hcCgoKSA9PiB0aGlzLm9wZW4oKSkpXG4gICAgICAgIC5zdWJzY3JpYmUoKGRiOiBhbnkpID0+IHtcbiAgICAgICAgICBjb25zdCB0cmFuc2FjdGlvbiA9IGRiLnRyYW5zYWN0aW9uKHNjaGVtYS5uYW1lLCAncmVhZHdyaXRlJyk7XG4gICAgICAgICAgY29uc3Qgc3RvcmUgPSB0cmFuc2FjdGlvbi5vYmplY3RTdG9yZShzY2hlbWEubmFtZSk7XG5cbiAgICAgICAgICBpZiAoXy5pc0FycmF5KGRhdGEpKSB7XG4gICAgICAgICAgICBfLmVhY2goZGF0YSwgZGF0YUl0ZW0gPT4ge1xuICAgICAgICAgICAgICBzdG9yZS5wdXQoZGF0YUl0ZW0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHN0b3JlLnB1dChkYXRhKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICB0cmFuc2FjdGlvbi5vbmNvbXBsZXRlID0gKCkgPT4ge1xuICAgICAgICAgICAgb2JzZXJ2ZXIubmV4dChkYXRhKTtcbiAgICAgICAgICAgIGRiLmNsb3NlKCk7XG4gICAgICAgICAgICBvYnNlcnZlci5jb21wbGV0ZSgpO1xuICAgICAgICAgIH07XG4gICAgICAgICAgZGIub25lcnJvciA9IChlcnJvckV2ZW50OiBhbnkpID0+IHtcbiAgICAgICAgICAgIGRiLmNsb3NlKCk7XG4gICAgICAgICAgICBvYnNlcnZlci5lcnJvcihlcnJvckV2ZW50LnRhcmdldC5lcnJvckNvZGUpO1xuICAgICAgICAgIH07XG4gICAgICAgIH0pO1xuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIEZ1bmN0aW9uIHRvIGFkZCBuZXcgZGF0YSBpbiB0aGUgZGJcbiAgICovXG4gIHBvc3Qoc2NoZW1hOiBhbnksIGRhdGE6IGFueSk6IE9ic2VydmFibGU8YW55PiB7XG4gICAgcmV0dXJuIE9ic2VydmFibGUuY3JlYXRlKChvYnNlcnZlcjogYW55KSA9PiB7XG4gICAgICB0aGlzLmNyZWF0ZShzY2hlbWEpXG4gICAgICAgIC5waXBlKG1lcmdlTWFwKCgpID0+IHRoaXMub3BlbigpKSlcbiAgICAgICAgLnN1YnNjcmliZSgoZGI6IGFueSkgPT4ge1xuICAgICAgICAgIGNvbnN0IHRyYW5zYWN0aW9uID0gZGIudHJhbnNhY3Rpb24oc2NoZW1hLm5hbWUsICdyZWFkd3JpdGUnKTtcbiAgICAgICAgICBjb25zdCBzdG9yZSA9IHRyYW5zYWN0aW9uLm9iamVjdFN0b3JlKHNjaGVtYS5uYW1lKTtcblxuICAgICAgICAgIC8vIENoZWNrIGlmIGRhdGEgaXMgYXJyYXkgb3IgYW4gb2JqZWN0XG4gICAgICAgICAgaWYgKF8uaXNBcnJheShkYXRhKSkge1xuICAgICAgICAgICAgXy5lYWNoKGRhdGEsIGRhdGFJdGVtID0+IHtcbiAgICAgICAgICAgICAgc3RvcmUuYWRkKGRhdGFJdGVtKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBzdG9yZS5hZGQoZGF0YSk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgdHJhbnNhY3Rpb24ub25jb21wbGV0ZSA9ICgpID0+IHtcbiAgICAgICAgICAgIG9ic2VydmVyLm5leHQoZGF0YSk7XG4gICAgICAgICAgICBkYi5jbG9zZSgpO1xuICAgICAgICAgICAgb2JzZXJ2ZXIuY29tcGxldGUoKTtcbiAgICAgICAgICB9O1xuICAgICAgICAgIGRiLm9uZXJyb3IgPSAoKSA9PiB7XG4gICAgICAgICAgICBvYnNlcnZlci5uZXh0KGRhdGEpO1xuICAgICAgICAgICAgZGIuY2xvc2UoKTtcbiAgICAgICAgICAgIG9ic2VydmVyLmNvbXBsZXRlKCk7XG4gICAgICAgICAgfTtcbiAgICAgICAgfSk7XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogRnVuY3Rpb24gdG8gZ2V0IHZhbHVlIGZvciBhIHBhcnRpY3VsYXIga2V5IGZyb20gdGhlIHRhYmxlXG4gICAqL1xuICBmaW5kT25lKHNjaGVtYTogYW55LCBrZXk6IHN0cmluZyk6IE9ic2VydmFibGU8YW55W10+IHtcbiAgICByZXR1cm4gbmV3IE9ic2VydmFibGUoKG9ic2VydmVyOiBhbnkpID0+IHtcbiAgICAgIHRoaXMuY3JlYXRlKHNjaGVtYSlcbiAgICAgICAgLnBpcGUobWVyZ2VNYXAoKCkgPT4gdGhpcy5vcGVuKCkpKVxuICAgICAgICAuc3Vic2NyaWJlKChkYjogYW55KSA9PiB7XG4gICAgICAgICAgY29uc3QgdHJhbnNhY3Rpb24gPSBkYi50cmFuc2FjdGlvbihzY2hlbWEubmFtZSwgJ3JlYWR3cml0ZScpO1xuICAgICAgICAgIGNvbnN0IHN0b3JlID0gdHJhbnNhY3Rpb24ub2JqZWN0U3RvcmUoc2NoZW1hLm5hbWUpO1xuICAgICAgICAgIGNvbnN0IHJlcXVlc3QgPSBzdG9yZS5nZXQoa2V5KTtcbiAgICAgICAgICByZXF1ZXN0Lm9uc3VjY2VzcyA9IHN1Y2Nlc3NFdmVudCA9PiB7XG4gICAgICAgICAgICBvYnNlcnZlci5uZXh0KHN1Y2Nlc3NFdmVudC50YXJnZXQucmVzdWx0KTtcbiAgICAgICAgICAgIGRiLmNsb3NlKCk7XG4gICAgICAgICAgICBvYnNlcnZlci5jb21wbGV0ZSgpO1xuICAgICAgICAgIH07XG4gICAgICAgICAgZGIub25lcnJvciA9IChldmVudDogYW55KSA9PiB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhldmVudC50YXJnZXQuZXJyb3JDb2RlKTtcbiAgICAgICAgICAgIGRiLmNsb3NlKCk7XG4gICAgICAgICAgICBvYnNlcnZlci5lcnJvcihldmVudC50YXJnZXQuZXJyb3JDb2RlKTtcbiAgICAgICAgICB9O1xuICAgICAgICB9KTtcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBGdW5jdGlvbiB0byBmaW5kIGFsbCB2YWx1ZXMgZm9yIGEgcGFydGljdWxhciB0YWJsZSBpbiB0aGUgZGJcbiAgICovXG4gIGZpbmRBbGwoc2NoZW1hOiBhbnkpOiBPYnNlcnZhYmxlPGFueVtdPiB7XG4gICAgcmV0dXJuIE9ic2VydmFibGUuY3JlYXRlKChvYnNlcnZlcjogYW55KSA9PiB7XG4gICAgICB0aGlzLmNyZWF0ZShzY2hlbWEpXG4gICAgICAgIC5waXBlKHN3aXRjaE1hcCgoKSA9PiB0aGlzLm9wZW4oKSkpXG4gICAgICAgIC5zdWJzY3JpYmUoKGRiOiBhbnkpID0+IHtcbiAgICAgICAgICBjb25zdCB0cmFuc2FjdGlvbiA9IGRiLnRyYW5zYWN0aW9uKHNjaGVtYS5uYW1lLCAncmVhZHdyaXRlJyk7XG4gICAgICAgICAgY29uc3Qgc3RvcmUgPSB0cmFuc2FjdGlvbi5vYmplY3RTdG9yZShzY2hlbWEubmFtZSk7XG4gICAgICAgICAgY29uc3Qgc3RvcmVJbmRleCA9IHN0b3JlLmluZGV4KHNjaGVtYS5rZXlQYXRoKTtcbiAgICAgICAgICBjb25zdCByZXF1ZXN0ID0gc3RvcmVJbmRleC5vcGVuQ3Vyc29yKCk7XG4gICAgICAgICAgbGV0IHJlc3VsdHM6IGFueVtdID0gW107XG5cbiAgICAgICAgICByZXF1ZXN0Lm9uc3VjY2VzcyA9IHN1Y2Nlc3NFdmVudCA9PiB7XG4gICAgICAgICAgICBjb25zdCBjdXJzb3IgPSBzdWNjZXNzRXZlbnQudGFyZ2V0LnJlc3VsdDtcbiAgICAgICAgICAgIGlmIChjdXJzb3IpIHtcbiAgICAgICAgICAgICAgcmVzdWx0cyA9IFsuLi5yZXN1bHRzLCBjdXJzb3IudmFsdWVdO1xuICAgICAgICAgICAgICBjdXJzb3IuY29udGludWUoKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIG9ic2VydmVyLm5leHQocmVzdWx0cyk7XG4gICAgICAgICAgICAgIGRiLmNsb3NlKCk7XG4gICAgICAgICAgICAgIG9ic2VydmVyLmNvbXBsZXRlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfTtcbiAgICAgICAgICBkYi5vbmVycm9yID0gKGV2ZW50OiBhbnkpID0+IHtcbiAgICAgICAgICAgIGRiLmNsb3NlKCk7XG4gICAgICAgICAgICBvYnNlcnZlci5lcnJvcihldmVudC50YXJnZXQuZXJyb3JDb2RlKTtcbiAgICAgICAgICB9O1xuICAgICAgICB9KTtcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBEZWxldGUgZGF0YSBmcm9tIHRoZSBkYlxuICAgKi9cbiAgZGVsZXRlKHNjaGVtYTogYW55LCBrZXk6IHN0cmluZyB8IHN0cmluZ1tdKTogT2JzZXJ2YWJsZTxhbnk+IHtcbiAgICByZXR1cm4gT2JzZXJ2YWJsZS5jcmVhdGUoKG9ic2VydmVyOiBhbnkpID0+IHtcbiAgICAgIHRoaXMub3BlbigpLnN1YnNjcmliZSgoZGI6IGFueSkgPT4ge1xuICAgICAgICBpZiAoIWRiLm9iamVjdFN0b3JlTmFtZXMuY29udGFpbnMoc2NoZW1hLm5hbWUpKSB7XG4gICAgICAgICAgY29uc3QgdHJhbnNhY3Rpb24gPSBkYi50cmFuc2FjdGlvbihzY2hlbWEubmFtZSwgJ3JlYWR3cml0ZScpO1xuICAgICAgICAgIGNvbnN0IHN0b3JlID0gdHJhbnNhY3Rpb24ub2JqZWN0U3RvcmUoc2NoZW1hLm5hbWUpO1xuXG4gICAgICAgICAgaWYgKF8uaXNBcnJheShrZXkpKSB7XG4gICAgICAgICAgICBfLmVhY2goa2V5LCBrZXlJdGVtID0+IHtcbiAgICAgICAgICAgICAgc3RvcmUuZGVsZXRlKGtleUl0ZW0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHN0b3JlLmRlbGV0ZShrZXkpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHRyYW5zYWN0aW9uLm9uY29tcGxldGUgPSAoKSA9PiB7XG4gICAgICAgICAgICBvYnNlcnZlci5uZXh0KGtleSk7XG4gICAgICAgICAgICBkYi5jbG9zZSgpO1xuICAgICAgICAgICAgb2JzZXJ2ZXIuY29tcGxldGUoKTtcbiAgICAgICAgICB9O1xuICAgICAgICAgIGRiLm9uZXJyb3IgPSAoZXJyb3JFdmVudDogYW55KSA9PiB7XG4gICAgICAgICAgICBkYi5jbG9zZSgpO1xuICAgICAgICAgICAgb2JzZXJ2ZXIuZXJyb3IoZXJyb3JFdmVudC50YXJnZXQuZXJyb3JDb2RlKTtcbiAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDcmVhdGUgYSBzY2hlbWEvdGFibGVcbiAgICovXG4gIGNyZWF0ZShzY2hlbWE6IGFueSk6IE9ic2VydmFibGU8YW55PiB7XG4gICAgcmV0dXJuIE9ic2VydmFibGUuY3JlYXRlKChvYnNlcnZlcjogYW55KSA9PiB7XG4gICAgICB0aGlzLm9wZW4oKS5zdWJzY3JpYmUoKHJlcXVlc3RSZXN1bHQ6IGFueSkgPT4ge1xuICAgICAgICBpZiAoIXJlcXVlc3RSZXN1bHQub2JqZWN0U3RvcmVOYW1lcy5jb250YWlucyhzY2hlbWEubmFtZSkpIHtcbiAgICAgICAgICAvKipcbiAgICAgICAgICAgKiBDbG9zZSBkYXRhYmFzZSB0byBhbGxvdyBvcGVuaW5nIHdpdGggbmV3IHZlcnNpb25cbiAgICAgICAgICAgKi9cbiAgICAgICAgICByZXF1ZXN0UmVzdWx0LmNsb3NlKCk7XG5cbiAgICAgICAgICAvKipcbiAgICAgICAgICAgKiBTZXQgYSBuZXcgY29ubmVjdGlvbiB3aXRoIG5ldyB2ZXJzaW9uIHRvIGFsbG93cyBjcmVhdGluZyBzY2hlbWFcbiAgICAgICAgICAgKi9cbiAgICAgICAgICBjb25zdCByZXF1ZXN0ID0gdGhpcy5faW5kZXhlZERCLm9wZW4oXG4gICAgICAgICAgICB0aGlzLl9kYk5hbWUsXG4gICAgICAgICAgICByZXF1ZXN0UmVzdWx0LnZlcnNpb24gKyAxXG4gICAgICAgICAgKTtcblxuICAgICAgICAgIHJlcXVlc3Qub251cGdyYWRlbmVlZGVkID0gZXZlbnQgPT4ge1xuICAgICAgICAgICAgY29uc3QgZGIgPSBldmVudC50YXJnZXQucmVzdWx0O1xuICAgICAgICAgICAgaWYgKCFkYi5vYmplY3RTdG9yZU5hbWVzLmNvbnRhaW5zKHNjaGVtYS5uYW1lKSkge1xuICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICogQ3JlYXRlIGNvcnJlc3BvbmRpbmcgc2NoZW1hXG4gICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICBjb25zdCBzdG9yZSA9IGRiLmNyZWF0ZU9iamVjdFN0b3JlKHNjaGVtYS5uYW1lLCB7XG4gICAgICAgICAgICAgICAga2V5UGF0aDogc2NoZW1hLmtleVBhdGhcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIHN0b3JlLmNyZWF0ZUluZGV4KHNjaGVtYS5rZXlQYXRoLCBzY2hlbWEua2V5UGF0aCwge1xuICAgICAgICAgICAgICAgIHVuaXF1ZTogdHJ1ZVxuICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICogQ3JlYXRlIGluZGV4ZXMgZm9yIHNjaGVtYSBpZiBzdXBwbGllZFxuICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgaWYgKHNjaGVtYS5pbmRleGVzKSB7XG4gICAgICAgICAgICAgICAgXy5lYWNoKHNjaGVtYS5pbmRleGVzLCAoc2NoZW1hSW5kZXg6IGFueSkgPT4ge1xuICAgICAgICAgICAgICAgICAgc3RvcmUuY3JlYXRlSW5kZXgoc2NoZW1hSW5kZXgsIHNjaGVtYUluZGV4KTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgKiBBZGQgZGF0YSBpZiBzdXBwbGllZFxuICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgaWYgKHNjaGVtYS5kYXRhKSB7XG4gICAgICAgICAgICAgICAgXy5lYWNoKHNjaGVtYS5kYXRhLCAoZGF0YUl0ZW06IGFueSkgPT4ge1xuICAgICAgICAgICAgICAgICAgc3RvcmUucHV0KGRhdGFJdGVtKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBvYnNlcnZlci5uZXh0KCdkb25lJyk7XG4gICAgICAgICAgICBvYnNlcnZlci5jb21wbGV0ZSgpO1xuICAgICAgICAgIH07XG5cbiAgICAgICAgICByZXF1ZXN0Lm9uZXJyb3IgPSBlcnJvckV2ZW50ID0+IHtcbiAgICAgICAgICAgIG9ic2VydmVyLmVycm9yKGVycm9yRXZlbnQudGFyZ2V0LmVycm9yQ29kZSk7XG4gICAgICAgICAgfTtcblxuICAgICAgICAgIHJlcXVlc3Qub25zdWNjZXNzID0gc3VjY2Vzc0V2ZW50ID0+IHtcbiAgICAgICAgICAgIHN1Y2Nlc3NFdmVudC50YXJnZXQucmVzdWx0LmNsb3NlKCk7XG4gICAgICAgICAgICBvYnNlcnZlci5uZXh0KCdkb25lJyk7XG4gICAgICAgICAgICBvYnNlcnZlci5jb21wbGV0ZSgpO1xuICAgICAgICAgIH07XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgb2JzZXJ2ZXIubmV4dCgnZG9uZScpO1xuICAgICAgICAgIG9ic2VydmVyLmNvbXBsZXRlKCk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIERlbGV0ZSB0aGUgd2hvbGUgZGF0YWJhc2VcbiAgICovXG4gIGNsZWFyKCk6IE9ic2VydmFibGU8YW55PiB7XG4gICAgcmV0dXJuIE9ic2VydmFibGUuY3JlYXRlKChvYnNlcnZlcjogYW55KSA9PiB7XG4gICAgICBjb25zdCByZXF1ZXN0ID0gdGhpcy5faW5kZXhlZERCLmRlbGV0ZURhdGFiYXNlKHRoaXMuX2RiTmFtZSk7XG5cbiAgICAgIHJlcXVlc3Qub25zdWNjZXNzID0gKCkgPT4ge1xuICAgICAgICBvYnNlcnZlci5uZXh0KCdkb25lJyk7XG4gICAgICAgIG9ic2VydmVyLmNvbXBsZXRlKCk7XG4gICAgICB9O1xuICAgICAgcmVxdWVzdC5vbmVycm9yID0gZXJyb3JFdmVudCA9PiB7XG4gICAgICAgIG9ic2VydmVyLmVycm9yKGVycm9yRXZlbnQudGFyZ2V0LmVycm9yQ29kZSk7XG4gICAgICB9O1xuICAgICAgcmVxdWVzdC5vbmJsb2NrZWQgPSBibG9ja0V2ZW50ID0+IHtcbiAgICAgICAgb2JzZXJ2ZXIuZXJyb3IoYmxvY2tFdmVudC50YXJnZXQuZXJyb3JDb2RlKTtcbiAgICAgIH07XG4gICAgfSk7XG4gIH1cblxuICBwcml2YXRlIG9wZW4oKTogT2JzZXJ2YWJsZTxhbnk+IHtcbiAgICByZXR1cm4gT2JzZXJ2YWJsZS5jcmVhdGUoKG9ic2VydmVyOiBhbnkpID0+IHtcbiAgICAgIGNvbnN0IHJlcXVlc3QgPSB0aGlzLl9pbmRleGVkREIub3Blbih0aGlzLl9kYk5hbWUpO1xuXG4gICAgICByZXF1ZXN0Lm9uc3VjY2VzcyA9IHN1Y2Nlc3NFdmVudCA9PiB7XG4gICAgICAgIG9ic2VydmVyLm5leHQoc3VjY2Vzc0V2ZW50LnRhcmdldC5yZXN1bHQpO1xuICAgICAgICBvYnNlcnZlci5jb21wbGV0ZSgpO1xuICAgICAgfTtcbiAgICAgIHJlcXVlc3Qub25lcnJvciA9IGVycm9yRXZlbnQgPT5cbiAgICAgICAgb2JzZXJ2ZXIuZXJyb3IoZXJyb3JFdmVudC50YXJnZXQuZXJyb3JDb2RlKTtcbiAgICB9KTtcbiAgfVxufVxuIiwiaW1wb3J0IHsgSW5qZWN0YWJsZSB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgSHR0cENsaWVudCwgSHR0cEVycm9yUmVzcG9uc2UgfSBmcm9tICdAYW5ndWxhci9jb21tb24vaHR0cCc7XG5pbXBvcnQgeyBNYW5pZmVzdFNlcnZpY2UgfSBmcm9tICcuL21hbmlmZXN0LnNlcnZpY2UnO1xuaW1wb3J0IHsgU3lzdGVtSW5mb1NlcnZpY2UgfSBmcm9tICcuL3N5c3RlbS1pbmZvLnNlcnZpY2UnO1xuaW1wb3J0IHsgT2JzZXJ2YWJsZSwgdGhyb3dFcnJvciwgb2YgfSBmcm9tICdyeGpzJztcbmltcG9ydCB7XG4gIGNhdGNoRXJyb3IsXG4gIG1hcCxcbiAgbWVyZ2VNYXAsXG4gIHN3aXRjaE1hcCxcbiAgdGFwXG59IGZyb20gJ3J4anMvaW50ZXJuYWwvb3BlcmF0b3JzJztcbmltcG9ydCB7IEh0dHBDb25maWcsIEluZGV4RGJTY2hlbWEgfSBmcm9tICcuLi9tb2RlbHMvaHR0cC1jb25maWcubW9kZWwnO1xuaW1wb3J0IHsgSFRUUF9DT05GSUcgfSBmcm9tICcuLi9jb25zdGFudHMvaHR0cC1jb25maWcuY29uc3RhbnQnO1xuaW1wb3J0IHsgSW5kZXhEYlNlcnZpY2UgfSBmcm9tICcuL2luZGV4LWRiLnNlcnZpY2UnO1xuXG5ASW5qZWN0YWJsZSh7IHByb3ZpZGVkSW46ICdyb290JyB9KVxuZXhwb3J0IGNsYXNzIE5neERoaXMySHR0cENsaWVudFNlcnZpY2Uge1xuICBjb25zdHJ1Y3RvcihcbiAgICBwcml2YXRlIGh0dHBDbGllbnQ6IEh0dHBDbGllbnQsXG4gICAgcHJpdmF0ZSBtYW5pZmVzdFNlcnZpY2U6IE1hbmlmZXN0U2VydmljZSxcbiAgICBwcml2YXRlIHN5c3RlbUluZm9TZXJ2aWNlOiBTeXN0ZW1JbmZvU2VydmljZSxcbiAgICBwcml2YXRlIGluZGV4RGJTZXJ2aWNlOiBJbmRleERiU2VydmljZVxuICApIHt9XG5cbiAgZ2V0KHVybDogc3RyaW5nLCBodHRwQ29uZmlnPzogSHR0cENvbmZpZyk6IE9ic2VydmFibGU8YW55PiB7XG4gICAgY29uc3QgbmV3SHR0cENvbmZpZyA9IHsgLi4uSFRUUF9DT05GSUcsIC4uLmh0dHBDb25maWcgfTtcblxuICAgIC8vIE1ha2UgYSBjYWxsIGRpcmVjdGx5IGZyb20gdXJsIGlmIGlzIGV4dGVybmFsIG9uZVxuICAgIGlmIChuZXdIdHRwQ29uZmlnLmlzRXh0ZXJuYWxMaW5rKSB7XG4gICAgICByZXR1cm4gdGhpcy5odHRwQ2xpZW50LmdldCh1cmwpO1xuICAgIH1cblxuICAgIC8vIGxvYWQgZnJvbSBpbmRleCBkYlxuICAgIGlmIChuZXdIdHRwQ29uZmlnLnVzZUluZGV4RGIpIHtcbiAgICAgIHJldHVybiB0aGlzLl9mZXRjaEZyb21JbmRleERiKG5ld0h0dHBDb25maWcpLnBpcGUoXG4gICAgICAgIG1lcmdlTWFwKChpbmRleERiUmVzcG9uc2U6IGFueSkgPT5cbiAgICAgICAgICBpbmRleERiUmVzcG9uc2VcbiAgICAgICAgICAgID8gb2YoaW5kZXhEYlJlc3BvbnNlKVxuICAgICAgICAgICAgOiB0aGlzLl9nZXQodXJsLCBuZXdIdHRwQ29uZmlnKS5waXBlKFxuICAgICAgICAgICAgICAgIG1lcmdlTWFwKChyZXNwb25zZTogYW55KSA9PlxuICAgICAgICAgICAgICAgICAgdGhpcy5fdXBkYXRlSW5kZXhEYihuZXdIdHRwQ29uZmlnLCByZXNwb25zZSlcbiAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgIClcbiAgICAgICAgKVxuICAgICAgKTtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcy5fZ2V0KHVybCwgbmV3SHR0cENvbmZpZyk7XG4gIH1cblxuICBwb3N0KHVybDogc3RyaW5nLCBkYXRhOiBhbnksIGh0dHBDb25maWc/OiBIdHRwQ29uZmlnKSB7XG4gICAgY29uc3QgbmV3SHR0cENvbmZpZyA9IHsgLi4uSFRUUF9DT05GSUcsIC4uLmh0dHBDb25maWcgfTtcblxuICAgIHJldHVybiB0aGlzLl9nZXRTYW5pdGl6ZWRSb290VXJsKG5ld0h0dHBDb25maWcpLnBpcGUoXG4gICAgICBtZXJnZU1hcChyb290VXJsID0+XG4gICAgICAgIHRoaXMuaHR0cENsaWVudFxuICAgICAgICAgIC5wb3N0KHJvb3RVcmwgKyB1cmwsIGRhdGEpXG4gICAgICAgICAgLnBpcGUoXG4gICAgICAgICAgICBtZXJnZU1hcCgocmVzcG9uc2U6IGFueSkgPT4ge1xuICAgICAgICAgICAgICBjb25zdCBkYXRhSWQgPSByZXNwb25zZS51aWQ7XG4gICAgICAgICAgICAgIHJldHVybiBuZXdIdHRwQ29uZmlnLnVzZUluZGV4RGJcbiAgICAgICAgICAgICAgICA/IGRhdGFJZFxuICAgICAgICAgICAgICAgICAgPyB0aGlzLl91cGRhdGVJbmRleERiKFxuICAgICAgICAgICAgICAgICAgICAgIG5ld0h0dHBDb25maWcsXG4gICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgLi4uZGF0YSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGlkOiBkYXRhSWRcbiAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICdDUkVBVEUnXG4gICAgICAgICAgICAgICAgICAgICkucGlwZShtYXAoKCkgPT4gcmVzcG9uc2UpKVxuICAgICAgICAgICAgICAgICAgOiBvZihyZXNwb25zZSlcbiAgICAgICAgICAgICAgICA6IG9mKHJlc3BvbnNlKTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgKVxuICAgICAgICAgIC5waXBlKGNhdGNoRXJyb3IodGhpcy5faGFuZGxlRXJyb3IpKVxuICAgICAgKSxcbiAgICAgIGNhdGNoRXJyb3IodGhpcy5faGFuZGxlRXJyb3IpXG4gICAgKTtcbiAgfVxuXG4gIHB1dCh1cmw6IHN0cmluZywgZGF0YTogYW55LCBodHRwQ29uZmlnPzogSHR0cENvbmZpZykge1xuICAgIGNvbnN0IG5ld0h0dHBDb25maWcgPSB7IC4uLkhUVFBfQ09ORklHLCAuLi5odHRwQ29uZmlnIH07XG5cbiAgICByZXR1cm4gdGhpcy5fZ2V0U2FuaXRpemVkUm9vdFVybChuZXdIdHRwQ29uZmlnKS5waXBlKFxuICAgICAgbWVyZ2VNYXAocm9vdFVybCA9PlxuICAgICAgICB0aGlzLmh0dHBDbGllbnQucHV0KHJvb3RVcmwgKyB1cmwsIGRhdGEpLnBpcGUoXG4gICAgICAgICAgbWVyZ2VNYXAoKHJlc3BvbnNlOiBhbnkpID0+XG4gICAgICAgICAgICBuZXdIdHRwQ29uZmlnLnVzZUluZGV4RGJcbiAgICAgICAgICAgICAgPyB0aGlzLl91cGRhdGVJbmRleERiKG5ld0h0dHBDb25maWcsIGRhdGEsICdVUERBVEUnKS5waXBlKFxuICAgICAgICAgICAgICAgICAgbWFwKCgpID0+IHJlc3BvbnNlKVxuICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgOiBvZihyZXNwb25zZSlcbiAgICAgICAgICApLFxuICAgICAgICAgIGNhdGNoRXJyb3IodGhpcy5faGFuZGxlRXJyb3IpXG4gICAgICAgIClcbiAgICAgICksXG4gICAgICBjYXRjaEVycm9yKHRoaXMuX2hhbmRsZUVycm9yKVxuICAgICk7XG4gIH1cblxuICBkZWxldGUodXJsOiBzdHJpbmcsIGh0dHBDb25maWc/OiBIdHRwQ29uZmlnKSB7XG4gICAgY29uc3QgbmV3SHR0cENvbmZpZyA9IHsgLi4uSFRUUF9DT05GSUcsIC4uLmh0dHBDb25maWcgfTtcblxuICAgIHJldHVybiB0aGlzLl9nZXRTYW5pdGl6ZWRSb290VXJsKG5ld0h0dHBDb25maWcpLnBpcGUoXG4gICAgICBtZXJnZU1hcChyb290VXJsID0+XG4gICAgICAgIHRoaXMuaHR0cENsaWVudFxuICAgICAgICAgIC5kZWxldGUocm9vdFVybCArIHVybClcbiAgICAgICAgICAucGlwZShcbiAgICAgICAgICAgIG1lcmdlTWFwKChyZXNwb25zZTogYW55KSA9PlxuICAgICAgICAgICAgICBuZXdIdHRwQ29uZmlnLnVzZUluZGV4RGJcbiAgICAgICAgICAgICAgICA/IHRoaXMuX3VwZGF0ZUluZGV4RGIobmV3SHR0cENvbmZpZywgbnVsbCwgJ0RFTEVURScpLnBpcGUoXG4gICAgICAgICAgICAgICAgICAgIG1hcCgoKSA9PiByZXNwb25zZSlcbiAgICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICA6IG9mKHJlc3BvbnNlKVxuICAgICAgICAgICAgKVxuICAgICAgICAgIClcbiAgICAgICAgICAucGlwZShjYXRjaEVycm9yKHRoaXMuX2hhbmRsZUVycm9yKSlcbiAgICAgICksXG4gICAgICBjYXRjaEVycm9yKHRoaXMuX2hhbmRsZUVycm9yKVxuICAgICk7XG4gIH1cblxuICAvLyBwcml2YXRlIG1ldGhvZHNcblxuICBwcml2YXRlIF9nZXQodXJsLCBodHRwQ29uZmlnOiBIdHRwQ29uZmlnKSB7XG4gICAgcmV0dXJuIHRoaXMuX2dldFNhbml0aXplZFJvb3RVcmwoaHR0cENvbmZpZykucGlwZShcbiAgICAgIG1lcmdlTWFwKHJvb3RVcmwgPT5cbiAgICAgICAgdGhpcy5odHRwQ2xpZW50LmdldChyb290VXJsICsgdXJsKS5waXBlKGNhdGNoRXJyb3IodGhpcy5faGFuZGxlRXJyb3IpKVxuICAgICAgKSxcbiAgICAgIGNhdGNoRXJyb3IodGhpcy5faGFuZGxlRXJyb3IpXG4gICAgKTtcbiAgfVxuICBwcml2YXRlIF9oYW5kbGVFcnJvcihlcnI6IEh0dHBFcnJvclJlc3BvbnNlKSB7XG4gICAgbGV0IGVycm9yID0gbnVsbDtcbiAgICBpZiAoZXJyLmVycm9yIGluc3RhbmNlb2YgRXJyb3JFdmVudCkge1xuICAgICAgLy8gQSBjbGllbnQtc2lkZSBvciBuZXR3b3JrIGVycm9yIG9jY3VycmVkLiBIYW5kbGUgaXQgYWNjb3JkaW5nbHkuXG4gICAgICBlcnJvciA9IHtcbiAgICAgICAgbWVzc2FnZTogZXJyLmVycm9yLFxuICAgICAgICBzdGF0dXM6IGVyci5zdGF0dXMsXG4gICAgICAgIHN0YXR1c1RleHQ6IGVyci5zdGF0dXNUZXh0XG4gICAgICB9O1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyBUaGUgYmFja2VuZCByZXR1cm5lZCBhbiB1bnN1Y2Nlc3NmdWwgcmVzcG9uc2UgY29kZS5cbiAgICAgIC8vIFRoZSByZXNwb25zZSBib2R5IG1heSBjb250YWluIGNsdWVzIGFzIHRvIHdoYXQgd2VudCB3cm9uZyxcbiAgICAgIGVycm9yID0ge1xuICAgICAgICBtZXNzYWdlOlxuICAgICAgICAgIGVyci5lcnJvciBpbnN0YW5jZW9mIE9iamVjdFxuICAgICAgICAgICAgPyBlcnIuZXJyb3IubWVzc2FnZVxuICAgICAgICAgICAgOiBlcnIuZXJyb3IgfHwgZXJyLm1lc3NhZ2UsXG4gICAgICAgIHN0YXR1czogZXJyLnN0YXR1cyxcbiAgICAgICAgc3RhdHVzVGV4dDogZXJyLnN0YXR1c1RleHRcbiAgICAgIH07XG4gICAgfVxuICAgIHJldHVybiB0aHJvd0Vycm9yKGVycm9yKTtcbiAgfVxuXG4gIHByaXZhdGUgX2dldFNhbml0aXplZFJvb3RVcmwoaHR0cENvbmZpZzogSHR0cENvbmZpZykge1xuICAgIHJldHVybiBodHRwQ29uZmlnLnVzZVJvb3RVcmxcbiAgICAgID8gdGhpcy5tYW5pZmVzdFNlcnZpY2UuZ2V0Um9vdFVybCgpXG4gICAgICA6IHRoaXMuX2dldEFwaVJvb3RVcmwoXG4gICAgICAgICAgaHR0cENvbmZpZy5pbmNsdWRlVmVyc2lvbk51bWJlcixcbiAgICAgICAgICBodHRwQ29uZmlnLnByZWZlclByZXZpb3VzQXBpVmVyc2lvblxuICAgICAgICApO1xuICB9XG5cbiAgcHJpdmF0ZSBfZ2V0QXBpUm9vdFVybChcbiAgICBpbmNsdWRlVmVyc2lvbk51bWJlcjogYm9vbGVhbiA9IGZhbHNlLFxuICAgIHByZWZlclByZXZpb3VzVmVyc2lvbjogYm9vbGVhbiA9IGZhbHNlXG4gICkge1xuICAgIGNvbnN0IHJvb3RVcmxQcm9taXNlID0gdGhpcy5tYW5pZmVzdFNlcnZpY2UuZ2V0Um9vdFVybCgpLnBpcGUoXG4gICAgICBzd2l0Y2hNYXAocm9vdFVybCA9PlxuICAgICAgICB0aGlzLnN5c3RlbUluZm9TZXJ2aWNlLmdldFN5c3RlbVZlcnNpb24oKS5waXBlKFxuICAgICAgICAgIG1hcCgodmVyc2lvbjogbnVtYmVyKSA9PiB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICByb290VXJsLFxuICAgICAgICAgICAgICB2ZXJzaW9uOiB2ZXJzaW9uIC0gMSA8PSAyNSA/IHZlcnNpb24gKyAxIDogdmVyc2lvblxuICAgICAgICAgICAgfTtcbiAgICAgICAgICB9KVxuICAgICAgICApXG4gICAgICApXG4gICAgKTtcbiAgICByZXR1cm4gcm9vdFVybFByb21pc2UucGlwZShcbiAgICAgIG1hcChcbiAgICAgICAgKHVybEluZm86IHsgcm9vdFVybDogc3RyaW5nOyB2ZXJzaW9uOiBudW1iZXIgfSkgPT5cbiAgICAgICAgICBgJHt1cmxJbmZvLnJvb3RVcmx9YXBpLyR7XG4gICAgICAgICAgICBpbmNsdWRlVmVyc2lvbk51bWJlciAmJiAhcHJlZmVyUHJldmlvdXNWZXJzaW9uXG4gICAgICAgICAgICAgID8gdXJsSW5mby52ZXJzaW9uICsgJy8nXG4gICAgICAgICAgICAgIDogcHJlZmVyUHJldmlvdXNWZXJzaW9uXG4gICAgICAgICAgICAgID8gdXJsSW5mby52ZXJzaW9uXG4gICAgICAgICAgICAgICAgPyB1cmxJbmZvLnZlcnNpb24gLSAxICsgJy8nXG4gICAgICAgICAgICAgICAgOiAnJ1xuICAgICAgICAgICAgICA6ICcnXG4gICAgICAgICAgfWBcbiAgICAgIClcbiAgICApO1xuICB9XG5cbiAgcHJpdmF0ZSBfdXBkYXRlSW5kZXhEYihcbiAgICBodHRwQ29uZmlnOiBIdHRwQ29uZmlnLFxuICAgIHJlcXVlc3REYXRhOiBhbnksXG4gICAgYWN0aW9uOiBzdHJpbmcgPSAnQ1JFQVRFJ1xuICApIHtcbiAgICBjb25zdCBpbmRleERiU2NoZW1hOiBJbmRleERiU2NoZW1hID0gaHR0cENvbmZpZy5pbmRleERiQ29uZmlnXG4gICAgICA/IGh0dHBDb25maWcuaW5kZXhEYkNvbmZpZy5zY2hlbWFcbiAgICAgIDogbnVsbDtcblxuICAgIGNvbnN0IGFycmF5S2V5ID0gaHR0cENvbmZpZy5pbmRleERiQ29uZmlnXG4gICAgICA/IGh0dHBDb25maWcuaW5kZXhEYkNvbmZpZy5hcnJheUtleVxuICAgICAgOiBudWxsO1xuXG4gICAgY29uc3QgaW5kZXhEYktleSA9IGh0dHBDb25maWcuaW5kZXhEYkNvbmZpZ1xuICAgICAgPyBodHRwQ29uZmlnLmluZGV4RGJDb25maWcua2V5XG4gICAgICA6IG51bGw7XG5cbiAgICBjb25zdCBkYXRhID0gYXJyYXlLZXkgPyByZXF1ZXN0RGF0YVthcnJheUtleV0gOiByZXF1ZXN0RGF0YTtcblxuICAgIHN3aXRjaCAoYWN0aW9uKSB7XG4gICAgICBjYXNlICdDUkVBVEUnOlxuICAgICAgY2FzZSAnVVBEQVRFJzpcbiAgICAgICAgcmV0dXJuIChhY3Rpb24gPT09ICdDUkVBVEUnXG4gICAgICAgICAgPyB0aGlzLmluZGV4RGJTZXJ2aWNlLnBvc3QoaW5kZXhEYlNjaGVtYSwgZGF0YSlcbiAgICAgICAgICA6IHRoaXMuaW5kZXhEYlNlcnZpY2UucHV0KGluZGV4RGJTY2hlbWEsIGRhdGEpXG4gICAgICAgICkucGlwZShcbiAgICAgICAgICBtYXAoKCkgPT4gcmVxdWVzdERhdGEpLFxuICAgICAgICAgIGNhdGNoRXJyb3IoZSA9PiB7XG4gICAgICAgICAgICBjb25zb2xlLndhcm4oJ0NvdWxkIG5vdCBzYXZlIGRhdGEgaW50byBpbmRleCBEQiwgRVJST1I6ICcgKyBlKTtcbiAgICAgICAgICAgIHJldHVybiBvZihyZXF1ZXN0RGF0YSk7XG4gICAgICAgICAgfSlcbiAgICAgICAgKTtcbiAgICAgIGNhc2UgJ0RFTEVURSc6XG4gICAgICAgIHJldHVybiB0aGlzLmluZGV4RGJTZXJ2aWNlLmRlbGV0ZShpbmRleERiU2NoZW1hLCBpbmRleERiS2V5KS5waXBlKFxuICAgICAgICAgIG1hcCgoKSA9PiByZXF1ZXN0RGF0YSksXG4gICAgICAgICAgY2F0Y2hFcnJvcihlID0+IHtcbiAgICAgICAgICAgIGNvbnNvbGUud2FybignQ291bGQgbm90IGRlbGV0ZSBkYXRhIGZyb20gaW5kZXggREIsIEVSUk9SOiAnICsgZSk7XG4gICAgICAgICAgICByZXR1cm4gb2YocmVxdWVzdERhdGEpO1xuICAgICAgICAgIH0pXG4gICAgICAgICk7XG4gICAgICBkZWZhdWx0OlxuICAgICAgICBjb25zb2xlLmxvZygnTm8gYWN0aW9uIGhhcyBiZWVuIHNwZWNpZmllZCcpO1xuICAgICAgICByZXR1cm4gb2YocmVxdWVzdERhdGEpO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgX2ZldGNoRnJvbUluZGV4RGIoaHR0cENvbmZpZzogSHR0cENvbmZpZykge1xuICAgIGNvbnN0IGluZGV4RGJTY2hlbWE6IEluZGV4RGJTY2hlbWEgPSBodHRwQ29uZmlnLmluZGV4RGJDb25maWdcbiAgICAgID8gaHR0cENvbmZpZy5pbmRleERiQ29uZmlnLnNjaGVtYVxuICAgICAgOiBudWxsO1xuXG4gICAgY29uc3QgaW5kZXhEYktleSA9IGh0dHBDb25maWcuaW5kZXhEYkNvbmZpZ1xuICAgICAgPyBodHRwQ29uZmlnLmluZGV4RGJDb25maWcua2V5XG4gICAgICA6IG51bGw7XG5cbiAgICByZXR1cm4gaW5kZXhEYktleVxuICAgICAgPyB0aGlzLmluZGV4RGJTZXJ2aWNlLmZpbmRPbmUoaW5kZXhEYlNjaGVtYSwgaW5kZXhEYktleSlcbiAgICAgIDogdGhpcy5pbmRleERiU2VydmljZS5maW5kQWxsKGluZGV4RGJTY2hlbWEpLnBpcGUoXG4gICAgICAgICAgbWFwKHJlc3BvbnNlID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGFycmF5S2V5ID0gaHR0cENvbmZpZy5pbmRleERiQ29uZmlnXG4gICAgICAgICAgICAgID8gaHR0cENvbmZpZy5pbmRleERiQ29uZmlnLmFycmF5S2V5XG4gICAgICAgICAgICAgIDogbnVsbDtcbiAgICAgICAgICAgIHJldHVybiByZXNwb25zZS5sZW5ndGggPiAwXG4gICAgICAgICAgICAgID8gYXJyYXlLZXlcbiAgICAgICAgICAgICAgICA/IHsgW2FycmF5S2V5XTogcmVzcG9uc2UgfVxuICAgICAgICAgICAgICAgIDogcmVzcG9uc2VcbiAgICAgICAgICAgICAgOiBudWxsO1xuICAgICAgICAgIH0pXG4gICAgICAgICk7XG4gIH1cbn1cbiJdLCJuYW1lcyI6WyJzd2l0Y2hNYXAiLCJfLmlzQXJyYXkiLCJfLmVhY2giLCJtZXJnZU1hcCJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7QUFBQTs7OztJQVlFLFlBQW9CLFVBQXNCO1FBQXRCLGVBQVUsR0FBVixVQUFVLENBQVk7UUFDeEMsSUFBSSxDQUFDLGVBQWUsR0FBRyxXQUFXLENBQUM7UUFDbkMsSUFBSSxDQUFDLGVBQWUsR0FBRyxLQUFLLENBQUM7S0FDOUI7Ozs7SUFFTSxXQUFXO1FBQ2hCLE9BQU8sSUFBSSxDQUFDLGVBQWUsR0FBRyxFQUFFLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxHQUFHLElBQUksQ0FBQyxVQUFVLENBQUMsR0FBRyxDQUFXLGlCQUFpQixDQUFDLENBQUMsSUFBSSxDQUN0RyxVQUFVLENBQUM7WUFDVCxPQUFPLENBQUMsSUFBSSxDQUFDLDJFQUEyRSxDQUFDLENBQUM7WUFDMUYsT0FBTyxFQUFFLENBQUMsSUFBSSxDQUFDLENBQUM7U0FDakIsQ0FBQyxFQUNGLEdBQUcsQ0FBQyxDQUFDLFFBQVE7WUFDWCxJQUFJLENBQUMsU0FBUyxHQUFHLFFBQVEsQ0FBQztZQUMxQixJQUFJLENBQUMsZUFBZSxHQUFHLElBQUksQ0FBQztTQUM3QixDQUFDLENBQUMsQ0FBQzs7Ozs7SUFHRCxVQUFVO1FBQ2YsT0FBTyxJQUFJLENBQUMsV0FB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