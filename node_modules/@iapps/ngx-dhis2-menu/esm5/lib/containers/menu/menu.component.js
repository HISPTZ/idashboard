/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes} checked by tsc
 */
import { Component } from '@angular/core';
import { trigger, state, style, transition, animate } from '@angular/animations';
import { MenuService } from '../../services/menu.service';
import { SystemStateService } from '../../services/system-state.service';
import { MENU_BACKGROUND_COLORS } from '../../constants/menu-background-colors';
var MenuComponent = /** @class */ (function () {
    function MenuComponent(menuService, systemStatusService) {
        this.menuService = menuService;
        this.systemStatusService = systemStatusService;
        this.rootUrl = '../../../';
        this.menuLoading = true;
        this.menuLoadingFail = false;
        this.loggedIn$ = this.systemStatusService.getLoginStatus();
        this.online = false;
        this.menuNotification = '';
        this.wasOffline = true;
        this.backgroundColor = '#ECECEC';
        this.showSidebar = false;
    }
    /**
     * @return {?}
     */
    MenuComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        var _this = this;
        this.systemStatusService.checkOnlineStatus().subscribe(function (onlineStatus) {
            _this.online = onlineStatus;
            if (_this.online && _this.wasOffline) {
                _this.menuNotification = 'You are online';
                _this.wasOffline = false;
                /**
                         * Hide notification status after sometimes
                         */
                setTimeout(function () {
                    _this.menuNotification = '';
                }, 3000);
                /**
                         * Load system settings if failed
                         */
                if (_this.menuLoadingFail) {
                    _this.menuLoading = true;
                    _this.getSystemSettings();
                }
            }
            else if (!_this.online) {
                _this.menuNotification = 'You are offline';
                _this.wasOffline = true;
            }
        });
        this.getSystemSettings();
    };
    /**
     * @param {?} e
     * @return {?}
     */
    MenuComponent.prototype.toggleSideBar = /**
     * @param {?} e
     * @return {?}
     */
    function (e) {
        e.stopPropagation();
        this.showSidebar = !this.showSidebar;
    };
    /**
     * @return {?}
     */
    MenuComponent.prototype.getSystemSettings = /**
     * @return {?}
     */
    function () {
        var _this = this;
        this.menuService.getSystemSettings(this.rootUrl).subscribe(function (settings) {
            if (settings) {
                _this.applicationTitle = settings['applicationTitle'];
                // get system current background style
                var /** @type {?} */ colorName = settings.hasOwnProperty('currentStyle')
                    ? settings['currentStyle'].split('/')[0]
                    : settings.hasOwnProperty('keyStyle')
                        ? settings['keyStyle'].split('/')[0]
                        : 'blue';
                _this.backgroundColor =
                    MENU_BACKGROUND_COLORS[colorName];
                _this.contextPath = settings.contextPath ? settings.contextPath + '/' : '';
            }
            _this.menuLoading = false;
            _this.menuLoadingFail = false;
        }, function () {
            _this.menuLoading = false;
            _this.menuLoadingFail = true;
        });
    };
    MenuComponent.decorators = [
        { type: Component, args: [{
                    selector: 'ngx-dhis2-menu',
                    template: "<div class=\"menu-container\">\n\n  <!-- notification area -->\n  <div class=\"menu-notification-area\" *ngIf=\"menuNotification !== ''\" [@open]>\n    {{ menuNotification }}\n  </div>\n  <!-- end of notification area -->\n  <!-- login form area -->\n  <div class=\"login-form-container\" *ngIf=\"!(loggedIn$ | async)\">\n    <app-login-form></app-login-form>\n  </div>\n  <!-- end of login form area -->\n\n  <!--menu loading area-->\n  <div class=\"menu-loader\" *ngIf=\"menuLoading\">\n    <app-menu-loader></app-menu-loader>\n  </div>\n  <!--end of menu loading area-->\n\n  <!--menu loading failed area-->\n  <div class=\"menu-content\" *ngIf=\"!menuLoading && menuLoadingFail\" style=\"background-color: #eeeeee\">\n    &nbsp;\n  </div>\n  <!--end of menu loading failed area-->\n\n  <!--menu content area-->\n  <div class=\"menu-content\" [style.background-color]=\"backgroundColor\" *ngIf=\"!menuLoading && !menuLoadingFail\">\n    <!--menu left block-->\n    <div class=\"menu-left-block\">\n\n      <!--menu brand area-->\n      <div class=\"menu-brand\">\n        <a [href]=\"rootUrl + 'dhis-web-commons-about/redirect.action'\">\n          <img [src]=\"rootUrl + 'api/staticContent/logo_banner'\" alt=\"\">\n        </a>\n      </div>\n      <!--end of menu brand area-->\n\n      <!--menu title area-->\n      <div class=\"menu-title-block\">\n        <a [href]=\"rootUrl + 'dhis-web-commons-about/redirect.action'\" class=\"menu-title\">\n          {{applicationTitle}}\n        </a>\n      </div>\n      <!--end of menu title area-->\n    </div>\n    <!--end of menu left block-->\n\n    <!--menu right block-->\n    <div class=\"menu-right-block\">\n      <div class=\"menu-notification-block\">\n        <app-menu-notification [rootUrl]=\"rootUrl\"></app-menu-notification>\n      </div>\n      <!--menu search block-->\n      <div class=\"menu-search-block\">\n        <app-menu-search></app-menu-search>\n      </div>\n      <!--end of menu search block-->\n\n      <!--menu profile block-->\n      <div class=\"menu-profile-block\">\n        <app-menu-profile [rootUrl]=\"rootUrl\" [contextPath]=\"contextPath\" [backgroundColor]=\"backgroundColor\"></app-menu-profile>\n      </div>\n      <!--end of menu profile block-->\n\n      <!--menu sidebar toggle button-->\n      <div\n        class=\"menu-toggle-button\"\n      >\n        <a\n          (click)=\"toggleSideBar($event)\"\n        >\n          <svg\n            class=\"menu-toggle-icon\"\n            viewBox=\"0 0 24 24\"\n          >\n            <path d=\"M4 8h4V4H4v4zm6 12h4v-4h-4v4zm-6 0h4v-4H4v4zm0-6h4v-4H4v4zm6 0h4v-4h-4v4zm6-10v4h4V4h-4zm-6 4h4V4h-4v4zm6 6h4v-4h-4v4zm0 6h4v-4h-4v4z\"></path>\n          </svg>\n        </a>\n      </div>\n      <!--end of menu sidebar toggle button-->\n\n      <!--sidebar menu block-->\n      <div class=\"sidebar-menu-nav\" *ngIf=\"showSidebar\">\n        <app-menu-side-bar></app-menu-side-bar>\n      </div>\n      <!--end of sidebar menu block-->\n      <div></div>\n    </div>\n    <!--end of menu right block-->\n  </div>\n  <!--end of menu content area-->\n</div>\n",
                    styles: [".menu-container{position:fixed;left:0;top:0;right:0;z-index:1400;height:48px}.menu-loader{height:100%}.menu-content{display:flex;width:100%;height:100%;justify-content:space-between}.menu-left-block,.menu-right-block{display:flex}.menu-brand{width:155px;height:100%;display:flex;justify-content:center;align-items:center}.menu-brand>a>img{display:block;margin:auto;max-height:44px;max-width:155px}.menu-title-block{overflow:hidden;white-space:nowrap;color:#fff;align-items:center;justify-items:center;display:flex;padding-right:1rem}.menu-title{font-size:1rem;font-weight:700;color:#fff;text-decoration:none;text-overflow:ellipsis;min-width:1px;overflow:hidden;white-space:nowrap}.menu-search-block{height:100%}.login-form-container{position:fixed;z-index:1500;top:2px;left:20%;min-height:42px;border-color:#f0c36d;background-color:#f9edbe;border-radius:3px}.menu-notification-area{position:fixed;z-index:1500;top:7px;left:20%;height:auto;border-color:#f0c36d;background-color:#f9edbe;border-radius:3px;padding:5px;font-size:15px}.menu-toggle-button{display:none;flex-direction:row;justify-content:flex-end;padding-right:10px;padding-top:6px}.menu-toggle-icon{display:inline-block;height:35px;width:35px;fill:#fff}.sidebar-menu-nav{position:absolute;top:100%;width:400px;height:100vh;right:0;z-index:900;font-size:14px;text-align:left;list-style:none;background-color:#fff;-webkit-background-clip:padding-box;transition:width .5s cubic-bezier(.39,-.04,.2,1);background-clip:padding-box;box-shadow:0 6px 12px rgba(0,0,0,.175)}@media (max-width:400px){.sidebar-menu-nav{width:95%}}@media (max-width:500px){.login-form-container{top:50px;left:2%;width:96%;height:auto}.menu-notification-area{left:2%;right:2%;width:96%;height:auto}}@media (max-width:999px){.menu-profile-block,.menu-search-block,.menu-title-block{display:none}.menu-brand{justify-content:flex-start;margin-left:15px}.menu-toggle-button{display:flex}}.menu-notification-block{display:flex;align-items:center;height:100%;margin-right:30px}@media (min-width:1010px){.sidebar-menu-nav{display:none!important}}"],
                    animations: [
                        trigger('open', [
                            state('in', style({
                                opacity: 1
                            })),
                            transition('void => *', [
                                style({
                                    opacity: 0
                                }),
                                animate(700)
                            ]),
                            transition('* => void', [
                                animate(400),
                                style({
                                    opacity: 0
                                })
                            ])
                        ])
                    ]
                },] },
    ];
    /** @nocollapse */
    MenuComponent.ctorParameters = function () { return [
        { type: MenuService },
        { type: SystemStateService }
    ]; };
    return MenuComponent;
}());
export { MenuComponent };
function MenuComponent_tsickle_Closure_declarations() {
    /** @type {?} */
    MenuComponent.prototype.rootUrl;
    /** @type {?} */
    MenuComponent.prototype.applicationTitle;
    /** @type {?} */
    MenuComponent.prototype.backgroundColor;
    /** @type {?} */
    MenuComponent.prototype.menuLoading;
    /** @type {?} */
    MenuComponent.prototype.menuLoadingFail;
    /** @type {?} */
    MenuComponent.prototype.loggedIn$;
    /** @type {?} */
    MenuComponent.prototype.online;
    /** @type {?} */
    MenuComponent.prototype.menuNotification;
    /** @type {?} */
    MenuComponent.prototype.wasOffline;
    /** @type {?} */
    MenuComponent.prototype.showSidebar;
    /** @type {?} */
    MenuComponent.prototype.contextPath;
    /** @type {?} */
    MenuComponent.prototype.menuService;
    /** @type {?} */
    MenuComponent.prototype.systemStatusService;
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWVudS5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AaWFwcHMvbmd4LWRoaXMyLW1lbnUvIiwic291cmNlcyI6WyJsaWIvY29udGFpbmVycy9tZW51L21lbnUuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7QUFBQSxPQUFPLEVBQUUsU0FBUyxFQUFVLE1BQU0sZUFBZSxDQUFDO0FBQ2xELE9BQU8sRUFDTCxPQUFPLEVBQ1AsS0FBSyxFQUNMLEtBQUssRUFDTCxVQUFVLEVBQ1YsT0FBTyxFQUNSLE1BQU0scUJBQXFCLENBQUM7QUFFN0IsT0FBTyxFQUFFLFdBQVcsRUFBRSxNQUFNLDZCQUE2QixDQUFDO0FBQzFELE9BQU8sRUFBRSxrQkFBa0IsRUFBRSxNQUFNLHFDQUFxQyxDQUFDO0FBQ3pFLE9BQU8sRUFBRSxzQkFBc0IsRUFBRSxNQUFNLHdDQUF3QyxDQUFDOztJQXVJOUUsdUJBQW9CLFdBQXdCLEVBQ2xDO1FBRFUsZ0JBQVcsR0FBWCxXQUFXLENBQWE7UUFDbEMsd0JBQW1CLEdBQW5CLG1CQUFtQjtRQUMzQixJQUFJLENBQUMsT0FBTyxHQUFHLFdBQVcsQ0FBQztRQUMzQixJQUFJLENBQUMsV0FBVyxHQUFHLElBQUksQ0FBQztRQUN4QixJQUFJLENBQUMsZUFBZSxHQUFHLEtBQUssQ0FBQztRQUM3QixJQUFJLENBQUMsU0FBUyxHQUFHLElBQUksQ0FBQyxtQkFBbUIsQ0FBQyxjQUFjLEVBQUUsQ0FBQztRQUMzRCxJQUFJLENBQUMsTUFBTSxHQUFHLEtBQUssQ0FBQztRQUNwQixJQUFJLENBQUMsZ0JBQWdCLEdBQUcsRUFBRSxDQUFDO1FBQzNCLElBQUksQ0FBQyxVQUFVLEdBQUcsSUFBSSxDQUFDO1FBQ3ZCLElBQUksQ0FBQyxlQUFlLEdBQUcsU0FBUyxDQUFDO1FBQ2pDLElBQUksQ0FBQyxXQUFXLEdBQUcsS0FBSyxDQUFDO0tBQzFCOzs7O0lBRUQsZ0NBQVE7OztJQUFSO1FBQUEsaUJBNEJDO1FBM0JDLElBQUks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QztnQ0FDSixPQUFPLEVBQUUsQ0FBQzs2QkFDWCxDQUFDLENBQ0g7NEJBQ0QsVUFBVSxDQUFDLFdBQVcsRUFBRTtnQ0FDdEIsS0FBSyxDQUFDO29DQUNKLE9BQU8sRUFBRSxDQUFDO2lDQUNYLENBQUM7Z0NBQ0YsT0FBTyxDQUFDLEdBQUcsQ0FBQzs2QkFDYixDQUFDOzRCQUNGLFVBQVUsQ0FBQyxXQUFXLEVBQUU7Z0NBQ3RCLE9BQU8sQ0FBQyxHQUFHLENBQUM7Z0NBQ1osS0FBSyxDQUFDO29DQUNKLE9BQU8sRUFBRSxDQUFDO2lDQUNYLENBQUM7NkJBQ0gsQ0FBQzt5QkFDSCxDQUFDO3FCQUNIO2lCQUNGOzs7O2dCQTNIUSxXQUFXO2dCQUNYLGtCQUFrQjs7d0JBVjNCOztTQXFJYSxhQUFhIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ29tcG9uZW50LCBPbkluaXQgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7XG4gIHRyaWdnZXIsXG4gIHN0YXRlLFxuICBzdHlsZSxcbiAgdHJhbnNpdGlvbixcbiAgYW5pbWF0ZVxufSBmcm9tICdAYW5ndWxhci9hbmltYXRpb25zJztcbmltcG9ydCB7IE9ic2VydmFibGUgfSBmcm9tICdyeGpzJztcbmltcG9ydCB7IE1lbnVTZXJ2aWNlIH0gZnJvbSAnLi4vLi4vc2VydmljZXMvbWVudS5zZXJ2aWNlJztcbmltcG9ydCB7IFN5c3RlbVN0YXRlU2VydmljZSB9IGZyb20gJy4uLy4uL3NlcnZpY2VzL3N5c3RlbS1zdGF0ZS5zZXJ2aWNlJztcbmltcG9ydCB7IE1FTlVfQkFDS0dST1VORF9DT0xPUlMgfSBmcm9tICcuLi8uLi9jb25zdGFudHMvbWVudS1iYWNrZ3JvdW5kLWNvbG9ycyc7XG5cbkBDb21wb25lbnQoe1xuICBzZWxlY3RvcjogJ25neC1kaGlzMi1tZW51JyxcbiAgdGVtcGxhdGU6IGA8ZGl2IGNsYXNzPVwibWVudS1jb250YWluZXJcIj5cblxuICA8IS0tIG5vdGlmaWNhdGlvbiBhcmVhIC0tPlxuICA8ZGl2IGNsYXNzPVwibWVudS1ub3RpZmljYXRpb24tYXJlYVwiICpuZ0lmPVwibWVudU5vdGlmaWNhdGlvbiAhPT0gJydcIiBbQG9wZW5dPlxuICAgIHt7IG1lbnVOb3RpZmljYXRpb24gfX1cbiAgPC9kaXY+XG4gIDwhLS0gZW5kIG9mIG5vdGlmaWNhdGlvbiBhcmVhIC0tPlxuICA8IS0tIGxvZ2luIGZvcm0gYXJlYSAtLT5cbiAgPGRpdiBjbGFzcz1cImxvZ2luLWZvcm0tY29udGFpbmVyXCIgKm5nSWY9XCIhKGxvZ2dlZEluJCB8IGFzeW5jKVwiPlxuICAgIDxhcHAtbG9naW4tZm9ybT48L2FwcC1sb2dpbi1mb3JtPlxuICA8L2Rpdj5cbiAgPCEtLSBlbmQgb2YgbG9naW4gZm9ybSBhcmVhIC0tPlxuXG4gIDwhLS1tZW51IGxvYWRpbmcgYXJlYS0tPlxuICA8ZGl2IGNsYXNzPVwibWVudS1sb2FkZXJcIiAqbmdJZj1cIm1lbnVMb2FkaW5nXCI+XG4gICAgPGFwcC1tZW51LWxvYWRlcj48L2FwcC1tZW51LWxvYWRlcj5cbiAgPC9kaXY+XG4gIDwhLS1lbmQgb2YgbWVudSBsb2FkaW5nIGFyZWEtLT5cblxuICA8IS0tbWVudSBsb2FkaW5nIGZhaWxlZCBhcmVhLS0+XG4gIDxkaXYgY2xhc3M9XCJtZW51LWNvbnRlbnRcIiAqbmdJZj1cIiFtZW51TG9hZGluZyAmJiBtZW51TG9hZGluZ0ZhaWxcIiBzdHlsZT1cImJhY2tncm91bmQtY29sb3I6ICNlZWVlZWVcIj5cbiAgICAmbmJzcDtcbiAgPC9kaXY+XG4gIDwhLS1lbmQgb2YgbWVudSBsb2FkaW5nIGZhaWxlZCBhcmVhLS0+XG5cbiAgPCEtLW1lbnUgY29udGVudCBhcmVhLS0+XG4gIDxkaXYgY2xhc3M9XCJtZW51LWNvbnRlbnRcIiBbc3R5bGUuYmFja2dyb3VuZC1jb2xvcl09XCJiYWNrZ3JvdW5kQ29sb3JcIiAqbmdJZj1cIiFtZW51TG9hZGluZyAmJiAhbWVudUxvYWRpbmdGYWlsXCI+XG4gICAgPCEtLW1lbnUgbGVmdCBibG9jay0tPlxuICAgIDxkaXYgY2xhc3M9XCJtZW51LWxlZnQtYmxvY2tcIj5cblxuICAgICAgPCEtLW1lbnUgYnJhbmQgYXJlYS0tPlxuICAgICAgPGRpdiBjbGFzcz1cIm1lbnUtYnJhbmRcIj5cbiAgICAgICAgPGEgW2hyZWZdPVwicm9vdFVybCArICdkaGlzLXdlYi1jb21tb25zLWFib3V0L3JlZGlyZWN0LmFjdGlvbidcIj5cbiAgICAgICAgICA8aW1nIFtzcmNdPVwicm9vdFVybCArICdhcGkvc3RhdGljQ29udGVudC9sb2dvX2Jhbm5lcidcIiBhbHQ9XCJcIj5cbiAgICAgICAgPC9hPlxuICAgICAgPC9kaXY+XG4gICAgICA8IS0tZW5kIG9mIG1lbnUgYnJhbmQgYXJlYS0tPlxuXG4gICAgICA8IS0tbWVudSB0aXRsZSBhcmVhLS0+XG4gICAgICA8ZGl2IGNsYXNzPVwibWVudS10aXRsZS1ibG9ja1wiPlxuICAgICAgICA8YSBbaHJlZl09XCJyb290VXJsICsgJ2RoaXMtd2ViLWNvbW1vbnMtYWJvdXQvcmVkaXJlY3QuYWN0aW9uJ1wiIGNsYXNzPVwibWVudS10aXRsZVwiPlxuICAgICAgICAgIHt7YXBwbGljYXRpb25UaXRsZX19XG4gICAgICAgIDwvYT5cbiAgICAgIDwvZGl2PlxuICAgICAgPCEtLWVuZCBvZiBtZW51IHRpdGxlIGFyZWEtLT5cbiAgICA8L2Rpdj5cbiAgICA8IS0tZW5kIG9mIG1lbnUgbGVmdCBibG9jay0tPlxuXG4gICAgPCEtLW1lbnUgcmlnaHQgYmxvY2stLT5cbiAgICA8ZGl2IGNsYXNzPVwibWVudS1yaWdodC1ibG9ja1wiPlxuICAgICAgPGRpdiBjbGFzcz1cIm1lbnUtbm90aWZpY2F0aW9uLWJsb2NrXCI+XG4gICAgICAgIDxhcHAtbWVudS1ub3RpZmljYXRpb24gW3Jvb3RVcmxdPVwicm9vdFVybFwiPjwvYXBwLW1lbnUtbm90aWZpY2F0aW9uPlxuICAgICAgPC9kaXY+XG4gICAgICA8IS0tbWVudSBzZWFyY2ggYmxvY2stLT5cbiAgICAgIDxkaXYgY2xhc3M9XCJtZW51LXNlYXJjaC1ibG9ja1wiPlxuICAgICAgICA8YXBwLW1lbnUtc2VhcmNoPjwvYXBwLW1lbnUtc2VhcmNoPlxuICAgICAgPC9kaXY+XG4gICAgICA8IS0tZW5kIG9mIG1lbnUgc2VhcmNoIGJsb2NrLS0+XG5cbiAgICAgIDwhLS1tZW51IHByb2ZpbGUgYmxvY2stLT5cbiAgICAgIDxkaXYgY2xhc3M9XCJtZW51LXByb2ZpbGUtYmxvY2tcIj5cbiAgICAgICAgPGFwcC1tZW51LXByb2ZpbGUgW3Jvb3RVcmxdPVwicm9vdFVybFwiIFtjb250ZXh0UGF0aF09XCJjb250ZXh0UGF0aFwiIFtiYWNrZ3JvdW5kQ29sb3JdPVwiYmFja2dyb3VuZENvbG9yXCI+PC9hcHAtbWVudS1wcm9maWxlPlxuICAgICAgPC9kaXY+XG4gICAgICA8IS0tZW5kIG9mIG1lbnUgcHJvZmlsZSBibG9jay0tPlxuXG4gICAgICA8IS0tbWVudSBzaWRlYmFyIHRvZ2dsZSBidXR0b24tLT5cbiAgICAgIDxkaXZcbiAgICAgICAgY2xhc3M9XCJtZW51LXRvZ2dsZS1idXR0b25cIlxuICAgICAgPlxuICAgICAgICA8YVxuICAgICAgICAgIChjbGljayk9XCJ0b2dnbGVTaWRlQmFyKCRldmVudClcIlxuICAgICAgICA+XG4gICAgICAgICAgPHN2Z1xuICAgICAgICAgICAgY2xhc3M9XCJtZW51LXRvZ2dsZS1pY29uXCJcbiAgICAgICAgICAgIHZpZXdCb3g9XCIwIDAgMjQgMjRcIlxuICAgICAgICAgID5cbiAgICAgICAgICAgIDxwYXRoIGQ9XCJNNCA4aDRWNEg0djR6bTYgMTJoNHYtNGgtNHY0em0tNiAwaDR2LTRINHY0em0wLTZoNHYtNEg0djR6bTYgMGg0di00aC00djR6bTYtMTB2NGg0VjRoLTR6bS02IDRoNFY0aC00djR6bTYgNmg0di00aC00djR6bTAgNmg0di00aC00djR6XCI+PC9wYXRoPlxuICAgICAgICAgIDwvc3ZnPlxuICAgICAgICA8L2E+XG4gICAgICA8L2Rpdj5cbiAgICAgIDwhLS1lbmQgb2YgbWVudSBzaWRlYmFyIHRvZ2dsZSBidXR0b24tLT5cblxuICAgICAgPCEtLXNpZGViYXIgbWVudSBibG9jay0tPlxuICAgICAgPGRpdiBjbGFzcz1cInNpZGViYXItbWVudS1uYXZcIiAqbmdJZj1cInNob3dTaWRlYmFyXCI+XG4gICAgICAgIDxhcHAtbWVudS1zaWRlLWJhcj48L2FwcC1tZW51LXNpZGUtYmFyPlxuICAgICAgPC9kaXY+XG4gICAgICA8IS0tZW5kIG9mIHNpZGViYXIgbWVudSBibG9jay0tPlxuICAgICAgPGRpdj48L2Rpdj5cbiAgICA8L2Rpdj5cbiAgICA8IS0tZW5kIG9mIG1lbnUgcmlnaHQgYmxvY2stLT5cbiAgPC9kaXY+XG4gIDwhLS1lbmQgb2YgbWVudSBjb250ZW50IGFyZWEtLT5cbjwvZGl2PlxuYCxcbiAgc3R5bGVzOiBbYC5tZW51LWNvbnRhaW5lcntwb3NpdGlvbjpmaXhlZDtsZWZ0OjA7dG9wOjA7cmlnaHQ6MDt6LWluZGV4OjE0MDA7aGVpZ2h0OjQ4cHh9Lm1lbnUtbG9hZGVye2hlaWdodDoxMDAlfS5tZW51LWNvbnRlbnR7ZGlzcGxheTpmbGV4O3dpZHRoOjEwMCU7aGVpZ2h0OjEwMCU7anVzdGlmeS1jb250ZW50OnNwYWNlLWJldHdlZW59Lm1lbnUtbGVmdC1ibG9jaywubWVudS1yaWdodC1ibG9ja3tkaXNwbGF5OmZsZXh9Lm1lbnUtYnJhbmR7d2lkdGg6MTU1cHg7aGVpZ2h0OjEwMCU7ZGlzcGxheTpmbGV4O2p1c3RpZnktY29udGVudDpjZW50ZXI7YWxpZ24taXRlbXM6Y2VudGVyfS5tZW51LWJyYW5kPmE+aW1ne2Rpc3BsYXk6YmxvY2s7bWFyZ2luOmF1dG87bWF4LWhlaWdodDo0NHB4O21heC13aWR0aDoxNTVweH0ubWVudS10aXRsZS1ibG9ja3tvdmVyZmxvdzpoaWRkZW47d2hpdGUtc3BhY2U6bm93cmFwO2NvbG9yOiNmZmY7YWxpZ24taXRlbXM6Y2VudGVyO2p1c3RpZnktaXRlbXM6Y2VudGVyO2Rpc3BsYXk6ZmxleDtwYWRkaW5nLXJpZ2h0OjFyZW19Lm1lbnUtdGl0bGV7Zm9udC1zaXplOjFyZW07Zm9udC13ZWlnaHQ6NzAwO2NvbG9yOiNmZmY7dGV4dC1kZWNvcmF0aW9uOm5vbmU7dGV4dC1vdmVyZmxvdzplbGxpcHNpczttaW4td2lkdGg6MXB4O292ZXJmbG93OmhpZGRlbjt3aGl0ZS1zcGFjZTpub3dyYXB9Lm1lbnUtc2VhcmNoLWJsb2Nre2hlaWdodDoxMDAlfS5sb2dpbi1mb3JtLWNvbnRhaW5lcntwb3NpdGlvbjpmaXhlZDt6LWluZGV4OjE1MDA7dG9wOjJweDtsZWZ0OjIwJTttaW4taGVpZ2h0OjQycHg7Ym9yZGVyLWNvbG9yOiNmMGMzNmQ7YmFja2dyb3VuZC1jb2xvcjojZjllZGJlO2JvcmRlci1yYWRpdXM6M3B4fS5tZW51LW5vdGlmaWNhdGlvbi1hcmVhe3Bvc2l0aW9uOmZpeGVkO3otaW5kZXg6MTUwMDt0b3A6N3B4O2xlZnQ6MjAlO2hlaWdodDphdXRvO2JvcmRlci1jb2xvcjojZjBjMzZkO2JhY2tncm91bmQtY29sb3I6I2Y5ZWRiZTtib3JkZXItcmFkaXVzOjNweDtwYWRkaW5nOjVweDtmb250LXNpemU6MTVweH0ubWVudS10b2dnbGUtYnV0dG9ue2Rpc3BsYXk6bm9uZTtmbGV4LWRpcmVjdGlvbjpyb3c7anVzdGlmeS1jb250ZW50OmZsZXgtZW5kO3BhZGRpbmctcmlnaHQ6MTBweDtwYWRkaW5nLXRvcDo2cHh9Lm1lbnUtdG9nZ2xlLWljb257ZGlzcGxheTppbmxpbmUtYmxvY2s7aGVpZ2h0OjM1cHg7d2lkdGg6MzVweDtmaWxsOiNmZmZ9LnNpZGViYXItbWVudS1uYXZ7cG9zaXRpb246YWJzb2x1dGU7dG9wOjEwMCU7d2lkdGg6NDAwcHg7aGVpZ2h0OjEwMHZoO3JpZ2h0OjA7ei1pbmRleDo5MDA7Zm9udC1zaXplOjE0cHg7dGV4dC1hbGlnbjpsZWZ0O2xpc3Qtc3R5bGU6bm9uZTtiYWNrZ3JvdW5kLWNvbG9yOiNmZmY7LXdlYmtpdC1iYWNrZ3JvdW5kLWNsaXA6cGFkZGluZy1ib3g7dHJhbnNpdGlvbjp3aWR0aCAuNXMgY3ViaWMtYmV6aWVyKC4zOSwtLjA0LC4yLDEpO2JhY2tncm91bmQtY2xpcDpwYWRkaW5nLWJveDtib3gtc2hhZG93OjAgNnB4IDEycHggcmdiYSgwLDAsMCwuMTc1KX1AbWVkaWEgKG1heC13aWR0aDo0MDBweCl7LnNpZGViYXItbWVudS1uYXZ7d2lkdGg6OTUlfX1AbWVkaWEgKG1heC13aWR0aDo1MDBweCl7LmxvZ2luLWZvcm0tY29udGFpbmVye3RvcDo1MHB4O2xlZnQ6MiU7d2lkdGg6OTYlO2hlaWdodDphdXRvfS5tZW51LW5vdGlmaWNhdGlvbi1hcmVhe2xlZnQ6MiU7cmlnaHQ6MiU7d2lkdGg6OTYlO2hlaWdodDphdXRvfX1AbWVkaWEgKG1heC13aWR0aDo5OTlweCl7Lm1lbnUtcHJvZmlsZS1ibG9jaywubWVudS1zZWFyY2gtYmxvY2ssLm1lbnUtdGl0bGUtYmxvY2t7ZGlzcGxheTpub25lfS5tZW51LWJyYW5ke2p1c3RpZnktY29udGVudDpmbGV4LXN0YXJ0O21hcmdpbi1sZWZ0OjE1cHh9Lm1lbnUtdG9nZ2xlLWJ1dHRvbntkaXNwbGF5OmZsZXh9fS5tZW51LW5vdGlmaWNhdGlvbi1ibG9ja3tkaXNwbGF5OmZsZXg7YWxpZ24taXRlbXM6Y2VudGVyO2hlaWdodDoxMDAlO21hcmdpbi1yaWdodDozMHB4fUBtZWRpYSAobWluLXdpZHRoOjEwMTBweCl7LnNpZGViYXItbWVudS1uYXZ7ZGlzcGxheTpub25lIWltcG9ydGFudH19YF0sXG4gIGFuaW1hdGlvbnM6IFtcbiAgICB0cmlnZ2VyKCdvcGVuJywgW1xuICAgICAgc3RhdGUoXG4gICAgICAgICdpbicsXG4gICAgICAgIHN0eWxlKHtcbiAgICAgICAgICBvcGFjaXR5OiAxXG4gICAgICAgIH0pXG4gICAgICApLFxuICAgICAgdHJhbnNpdGlvbigndm9pZCA9PiAqJywgW1xuICAgICAgICBzdHlsZSh7XG4gICAgICAgICAgb3BhY2l0eTogMFxuICAgICAgICB9KSxcbiAgICAgICAgYW5pbWF0ZSg3MDApXG4gICAgICBdKSxcbiAgICAgIHRyYW5zaXRpb24oJyogPT4gdm9pZCcsIFtcbiAgICAgICAgYW5pbWF0ZSg0MDApLFxuICAgICAgICBzdHlsZSh7XG4gICAgICAgICAgb3BhY2l0eTogMFxuICAgICAgICB9KVxuICAgICAgXSlcbiAgICBdKVxuICBdXG59KVxuZXhwb3J0IGNsYXNzIE1lbnVDb21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQge1xuICByb290VXJsOiBzdHJpbmc7XG4gIGFwcGxpY2F0aW9uVGl0bGU6IHN0cmluZztcbiAgYmFja2dyb3VuZENvbG9yOiBzdHJpbmc7XG4gIG1lbnVMb2FkaW5nOiBib29sZWFuO1xuICBtZW51TG9hZGluZ0ZhaWw6IGJvb2xlYW47XG4gIGxvZ2dlZEluJDogT2JzZXJ2YWJsZTxib29sZWFuPjtcbiAgb25saW5lOiBib29sZWFuO1xuICBtZW51Tm90aWZpY2F0aW9uOiBzdHJpbmc7XG4gIHdhc09mZmxpbmU6IGJvb2xlYW47XG4gIHNob3dTaWRlYmFyOiBib29sZWFuO1xuICBjb250ZXh0UGF0aDogc3RyaW5nO1xuXG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgbWVudVNlcnZpY2U6IE1lbnVTZXJ2aWNlLFxuICAgIHByaXZhdGUgc3lzdGVtU3RhdHVzU2VydmljZTogU3lzdGVtU3RhdGVTZXJ2aWNlKSB7XG4gICAgdGhpcy5yb290VXJsID0gJy4uLy4uLy4uLyc7XG4gICAgdGhpcy5tZW51TG9hZGluZyA9IHRydWU7XG4gICAgdGhpcy5tZW51TG9hZGluZ0ZhaWwgPSBmYWxzZTtcbiAgICB0aGlzLmxvZ2dlZEluJCA9IHRoaXMuc3lzdGVtU3RhdHVzU2VydmljZS5nZXRMb2dpblN0YXR1cygpO1xuICAgIHRoaXMub25saW5lID0gZmFsc2U7XG4gICAgdGhpcy5tZW51Tm90aWZpY2F0aW9uID0gJyc7XG4gICAgdGhpcy53YXNPZmZsaW5lID0gdHJ1ZTtcbiAgICB0aGlzLmJhY2tncm91bmRDb2xvciA9ICcjRUNFQ0VDJztcbiAgICB0aGlzLnNob3dTaWRlYmFyID0gZmFsc2U7XG4gIH1cblxuICBuZ09uSW5pdCgpIHtcbiAgICB0aGlzLnN5c3RlbVN0YXR1c1NlcnZpY2UuY2hlY2tPbmxpbmVTdGF0dXMoKS5zdWJzY3JpYmUoKG9ubGluZVN0YXR1cykgPT4ge1xuICAgICAgdGhpcy5vbmxpbmUgPSBvbmxpbmVTdGF0dXM7XG4gICAgICBpZiAodGhpcy5vbmxpbmUgJiYgdGhpcy53YXNPZmZsaW5lKSB7XG4gICAgICAgIHRoaXMubWVudU5vdGlmaWNhdGlvbiA9ICdZb3UgYXJlIG9ubGluZSc7XG4gICAgICAgIHRoaXMud2FzT2ZmbGluZSA9IGZhbHNlO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBIaWRlIG5vdGlmaWNhdGlvbiBzdGF0dXMgYWZ0ZXIgc29tZXRpbWVzXG4gICAgICAgICAqL1xuICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICB0aGlzLm1lbnVOb3RpZmljYXRpb24gPSAnJztcbiAgICAgICAgfSwgMzAwMCk7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIExvYWQgc3lzdGVtIHNldHRpbmdzIGlmIGZhaWxlZFxuICAgICAgICAgKi9cbiAgICAgICAgaWYgKHRoaXMubWVudUxvYWRpbmdGYWlsKSB7XG4gICAgICAgICAgdGhpcy5tZW51TG9hZGluZyA9IHRydWU7XG4gICAgICAgICAgdGhpcy5nZXRTeXN0ZW1TZXR0aW5ncygpO1xuICAgICAgICB9XG5cbiAgICAgIH0gZWxzZSBpZiAoIXRoaXMub25saW5lKSB7XG4gICAgICAgIHRoaXMubWVudU5vdGlmaWNhdGlvbiA9ICdZb3UgYXJlIG9mZmxpbmUnO1xuICAgICAgICB0aGlzLndhc09mZmxpbmUgPSB0cnVlO1xuICAgICAgfVxuICAgIH0pO1xuICAgIHRoaXMuZ2V0U3lzdGVtU2V0dGluZ3MoKTtcbiAgfVxuXG4gIHRvZ2dsZVNpZGVCYXIoZSkge1xuICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgdGhpcy5zaG93U2lkZWJhciA9ICF0aGlzLnNob3dTaWRlYmFyO1xuICB9XG5cbiAgZ2V0U3lzdGVtU2V0dGluZ3MoKSB7XG4gICAgdGhpcy5tZW51U2VydmljZS5nZXRTeXN0ZW1TZXR0aW5ncyh0aGlzLnJvb3RVcmwpLnN1YnNjcmliZShcbiAgICAgIChzZXR0aW5nczogYW55KSA9PiB7XG4gICAgICAgIGlmIChzZXR0aW5ncykge1xuICAgICAgICAgIHRoaXMuYXBwbGljYXRpb25UaXRsZSA9IHNldHRpbmdzWydhcHBsaWNhdGlvblRpdGxlJ107XG5cbiAgICAgICAgICAvLyBnZXQgc3lzdGVtIGN1cnJlbnQgYmFja2dyb3VuZCBzdHlsZVxuICAgICAgICAgIGNvbnN0IGNvbG9yTmFtZSA9IHNldHRpbmdzLmhhc093blByb3BlcnR5KCdjdXJyZW50U3R5bGUnKVxuICAgICAgICAgICAgPyBzZXR0aW5nc1snY3VycmVudFN0eWxlJ10uc3BsaXQoJy8nKVswXVxuICAgICAgICAgICAgOiBzZXR0aW5ncy5oYXNPd25Qcm9wZXJ0eSgna2V5U3R5bGUnKVxuICAgICAgICAgICAgICA/IHNldHRpbmdzWydrZXlTdHlsZSddLnNwbGl0KCcvJylbMF1cbiAgICAgICAgICAgICAgOiAnYmx1ZSc7XG4gICAgICAgICAgdGhpcy5iYWNrZ3JvdW5kQ29sb3IgPVxuICAgICAgICAgICAgTUVOVV9CQUNLR1JPVU5EX0NPTE9SU1tjb2xvck5hbWVdO1xuXG4gICAgICAgICAgdGhpcy5jb250ZXh0UGF0aCA9IHNldHRpbmdzLmNvbnRleHRQYXRoID8gc2V0dGluZ3MuY29udGV4dFBhdGggKyAnLycgOiAnJztcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm1lbnVMb2FkaW5nID0gZmFsc2U7XG4gICAgICAgIHRoaXMubWVudUxvYWRpbmdGYWlsID0gZmFsc2U7XG4gICAgICB9LFxuICAgICAgKCkgPT4ge1xuICAgICAgICB0aGlzLm1lbnVMb2FkaW5nID0gZmFsc2U7XG4gICAgICAgIHRoaXMubWVudUxvYWRpbmdGYWlsID0gdHJ1ZTtcbiAgICAgIH1cbiAgICApO1xuICB9XG59XG4iXX0=