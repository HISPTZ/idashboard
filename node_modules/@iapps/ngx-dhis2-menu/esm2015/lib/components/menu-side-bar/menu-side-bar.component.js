/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes} checked by tsc
 */
import { Component, Input } from '@angular/core';
import { MenuService } from '../../services/menu.service';
import { PROFILE_MENUS } from '../../constants/profile-menus';
import { LOG_OUT } from '../../icons';
export class MenuSideBarComponent {
    /**
     * @param {?} menuService
     */
    constructor(menuService) {
        this.menuService = menuService;
        this.showProfile = false;
        this.rootUrl = '../../../';
        this.loadingUser = true;
        this.apps = [];
        this.originalApps = [];
        this.loadingModules = true;
        this.profileMenus = PROFILE_MENUS;
        this.filteredApp = '';
        this.showSidebarApps = false;
        this.logOutIcon = LOG_OUT;
    }
    /**
     * @return {?}
     */
    ngOnInit() {
        this.menuService.getUserInfo(this.rootUrl).subscribe((profile) => {
            if (profile) {
                this.currentUser = {
                    name: profile.displayName,
                    email: profile.email
                };
            }
            this.loadingUser = false;
        });
        this.menuService
            .getMenuModules(this.rootUrl)
            .subscribe((menuModules) => {
            if (menuModules !== null) {
                this.loadingModules = false;
                this.originalApps = [...menuModules];
                this.apps = this._prepareMenuModules();
            }
        });
    }
    /**
     * @return {?}
     */
    _prepareMenuModules() {
        return this.filteredApp === ''
            ? this.originalApps.filter((menu) => {
                return !menu.onlyShowOnSearch;
            })
            : this.originalApps;
    }
    /**
     * @param {?} e
     * @return {?}
     */
    toggleSidebarMenus(e) {
        e.stopPropagation();
        this.showSidebarApps = !this.showSidebarApps;
    }
    /**
     * @return {?}
     */
    updateMenuModules() {
        this.apps = this._prepareMenuModules();
    }
}
MenuSideBarComponent.decorators = [
    { type: Component, args: [{
                selector: 'app-menu-side-bar',
                template: `<div class="sidebar-container">
  <div class="sidebar-user-profile-block">
    <div class="sidebar-user-profile-logo" *ngIf="!loadingUser">{{currentUser?.name | abbreviate}}</div>
    <div class="sidebar-user-profile-info">
      <div>
        <div class="sidebar-user-name" *ngIf="!loadingUser">{{currentUser?.name}}</div>
        <div class="sidebar-user-email" *ngIf="!loadingUser">{{currentUser?.email}}</div>
      </div>
    </div>
  </div>
  <ul class="sidebar-list-block">
    <li [ngClass]="{
          'sidebar-app-hidden': !showSidebarApps
        }">
      <input type="text" class="sidebar-app-input" placeholder="Search Apps" [(ngModel)]="filteredApp" (ngModelChange)="updateMenuModules()">
    </li>
    <li class="sidebar-app-list" [ngClass]="{
          'sidebar-app-hidden': !showSidebarApps
        }">
      <a *ngFor="let app of  apps | filterByName: filteredApp" [href]="app.defaultAction" class="sidebar-app-menu-btn">
        <div class="sidebar-app-menu-btn-content">
          <img alt="" [src]="app.icon" title="{{app.displayName}}">
          <div class="app-menu-name">{{app.displayName}}</div>
        </div>
      </a>
    </li>
    <li *ngFor="let profileMenu of profileMenus">
      <a [href]="rootUrl + profileMenu.defaultAction">
        <img alt="" [src]="profileMenu.icon"> {{profileMenu.name}}
      </a>
    </li>
    <li>
      <a [href]="rootUrl + 'dhis-web-commons-security/logout.action'">
        <img [src]="logOutIcon"> Log Out
      </a>
    </li>
  </ul>
</div>`,
                styles: [`.sidebar-user-profile-block{text-align:left;background-color:#eee;height:50px;padding:5px;display:flex}.sidebar-user-profile-logo{height:40px;display:flex;align-items:center;justify-content:center;font-size:14px;font-weight:500;color:#9e9e9e;width:40px;border-radius:25px;text-align:center;background-color:#ddd}.sidebar-user-profile-info{display:flex;padding-left:10px;align-items:center}.sidebar-list-block{list-style-type:none;margin:0;padding:0;display:block}.sidebar-hidden{display:none!important}.sidebar-app-input{border-style:none;border-bottom:1px solid #eee;color:#777;width:100%;font-size:12px;padding:5px 7px}.sidebar-app-input:focus{outline:0}.sidebar-list-block li a{text-decoration:none;font-size:13px;display:block;color:#000;border-bottom:1px solid #eee;padding:7px 10px}.sidebar-list-block li a img{height:15px}.sidebar-app-list{display:flex;overflow:auto;height:200px;flex-wrap:wrap}.sidebar-app-menu-btn{display:flex!important;align-items:center;justify-content:center;margin:5px;text-decoration:none;border-radius:3px;border:1px solid #eee;transition:all .2s ease-in-out;width:80px;height:80px}.sidebar-app-menu-btn-content{text-align:center}.app-menu-name{margin-top:5px;font-size:11px}.sidebar-user-name{font-size:13px}.sidebar-user-email{font-size:11px;color:#777;font-style:italic}`]
            },] },
];
/** @nocollapse */
MenuSideBarComponent.ctorParameters = () => [
    { type: MenuService }
];
MenuSideBarComponent.propDecorators = {
    rootUrl: [{ type: Input }]
};
function MenuSideBarComponent_tsickle_Closure_declarations() {
    /** @type {?} */
    MenuSideBarComponent.prototype.rootUrl;
    /** @type {?} */
    MenuSideBarComponent.prototype.showProfile;
    /** @type {?} */
    MenuSideBarComponent.prototype.currentUser;
    /** @type {?} */
    MenuSideBarComponent.prototype.loadingUser;
    /** @type {?} */
    MenuSideBarComponent.prototype.profileMenus;
    /** @type {?} */
    MenuSideBarComponent.prototype.apps;
    /** @type {?} */
    MenuSideBarComponent.prototype.originalApps;
    /** @type {?} */
    MenuSideBarComponent.prototype.loadingModules;
    /** @type {?} */
    MenuSideBarComponent.prototype.filteredApp;
    /** @type {?} */
    MenuSideBarComponent.prototype.showSidebarApps;
    /** @type {?} */
    MenuSideBarComponent.prototype.logOutIcon;
    /** @type {?} */
    MenuSideBarComponent.prototype.menuService;
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWVudS1zaWRlLWJhci5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AaWFwcHMvbmd4LWRoaXMyLW1lbnUvIiwic291cmNlcyI6WyJsaWIvY29tcG9uZW50cy9tZW51LXNpZGUtYmFyL21lbnUtc2lkZS1iYXIuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7QUFBQSxPQUFPLEVBQUUsU0FBUyxFQUFFLEtBQUssRUFBVSxNQUFNLGVBQWUsQ0FBQztBQUN6RCxPQUFPLEVBQUUsV0FBVyxFQUFFLE1BQU0sNkJBQTZCLENBQUM7QUFDMUQsT0FBTyxFQUFFLGFBQWEsRUFBRSxNQUFNLCtCQUErQixDQUFDO0FBQzlELE9BQU8sRUFBRSxPQUFPLEVBQUUsTUFBTSxhQUFhLENBQUM7QUE0Q3RDLE1BQU07Ozs7SUFjSixZQUFvQixXQUF3QjtRQUF4QixnQkFBVyxHQUFYLFdBQVcsQ0FBYTtRQUMxQyxJQUFJLENBQUMsV0FBVyxHQUFHLEtBQUssQ0FBQztRQUN6QixJQUFJLENBQUMsT0FBTyxHQUFHLFdBQVcsQ0FBQztRQUMzQixJQUFJLENBQUMsV0FBVyxHQUFHLElBQUksQ0FBQztRQUN4QixJQUFJLENBQUMsSUFBSSxHQUFHLEVBQUUsQ0FBQztRQUNmLElBQUksQ0FBQyxZQUFZLEdBQUcsRUFBRSxDQUFDO1FBQ3ZCLElBQUksQ0FBQyxjQUFjLEdBQUcsSUFBSSxDQUFDO1FBQzNCLElBQUksQ0FBQyxZQUFZLEdBQUcsYUFBYSxDQUFDO1FBQ2xDLElBQUksQ0FBQyxXQUFXLEdBQUcsRUFBRSxDQUFDO1FBQ3RCLElBQUksQ0FBQyxlQUFlLEdBQUcsS0FBSyxDQUFDO1FBQzdCLElBQUksQ0FBQyxVQUFVLEdBQUcsT0FBTyxDQUFDO0tBQzNCOzs7O0lBRUQsUUFBUTtRQUNOLElBQUksQ0FBQyxXQUFXLENBQUMsV0FBVyxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQyxTQUFTLENBQUMsQ0FBQyxPQUFZLEVBQUUsRUFBRTtZQUNwRSxFQUFFLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDO2dCQUNaLElBQUksQ0FBQyxXQUFXLEdBQUc7b0JBQ2pCLElBQUksRUFBRSxPQUFPLENBQUMsV0FBVztvQkFDekIsS0FBSyxFQUFFLE9BQU8sQ0FBQyxLQUFLO2lCQUNyQixDQUFDO2FBQ0g7WUFFRCxJQUFJLENBQUMsV0FBVyxHQUFHLEtBQUssQ0FBQztTQUMxQixDQUFDLENBQUM7UUFFSCxJQUFJLENBQUMsV0FBVzthQUNiLGNBQWMsQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDO2FBQzVCLFNBQVMsQ0FBQyxDQUFDLFdBQWdCLEVBQUUsRUFBRTtZQUM5QixFQUFFLENBQUMsQ0FBQyxXQUFXLEtBQUssSUFBSSxDQUFDLENBQUMsQ0FBQztnQkFDekIsSUFBSSxDQUFDLGNBQWMsR0FBRyxLQUFLLENBQUM7Z0JBQzVCLElBQUksQ0FBQyxZQUFZLEdBQUcsQ0FBQyxHQUFHLFdBQVcsQ0FBQyxDQUFDO2dCQUNyQyxJQUFJLENBQUMsSUFBSSxHQUFHLElBQUksQ0FBQyxtQkFBbUIsRUFBRSxDQUFDO2FBQ3hDO1NBQ0YsQ0FBQyxDQUFDO0tBQ047Ozs7SUFFTyxtQkFBbUI7UUFDekIsTUFBTSxDQUFDLElBQUksQ0FBQyxXQUFXLEtBQUssRUFBRTtZQUM1QixDQUFDLENBQUMsSUFBSSxDQUFDLFlBQVksQ0FBQyxNQUFNLENBQUMsQ0FBQyxJQUFTLEVBQUUsRUFBRTtnQkFDckMsTUFBTSxDQUFDLENBQUMsSUFBSSxDQUFDLGdCQUFnQixDQUFDO2FBQy9CLENBQUM7WUFDSixDQUFDLENBQUMsSUFBSSxDQUFDLFlBQVksQ0FBQzs7Ozs7O0lBR3hCLGtCQUFrQixDQUFDLENBQUM7UUFDbEIsQ0FBQyxDQUFDLGVBQWUsRUFBRSxDQUFDO1FBQ3BCLElBQUksQ0FBQyxlQUFlLEdBQUcsQ0FBQyxJQUFJLENBQUMsZUFBZSxDQUFDO0tBQzlDOzs7O0lBRUQsaUJBQWlCO1FBQ2YsSUFBSSxDQUFDLElBQUksR0FBRyxJQUFJLENBQUMsbUJBQW1CLEVBQUUsQ0FBQztLQUN4Qzs7O1lBM0dGLFNBQVMsU0FBQztnQkFDVCxRQUFRLEVBQUUsbUJBQW1CO2dCQUM3QixRQUFRLEVBQUU7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7T0FxQ0w7Z0JBQ0wsTUFBTSxFQUFFLENBQUMsNHhDQUE0eEMsQ0FBQzthQUN2eUM7Ozs7WUE3Q1EsV0FBVzs7O3NCQStDakIsS0FBSyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENvbXBvbmVudCwgSW5wdXQsIE9uSW5pdCB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgTWVudVNlcnZpY2UgfSBmcm9tICcuLi8uLi9zZXJ2aWNlcy9tZW51LnNlcnZpY2UnO1xuaW1wb3J0IHsgUFJPRklMRV9NRU5VUyB9IGZyb20gJy4uLy4uL2NvbnN0YW50cy9wcm9maWxlLW1lbnVzJztcbmltcG9ydCB7IExPR19PVVQgfSBmcm9tICcuLi8uLi9pY29ucyc7XG5cbkBDb21wb25lbnQoe1xuICBzZWxlY3RvcjogJ2FwcC1tZW51LXNpZGUtYmFyJyxcbiAgdGVtcGxhdGU6IGA8ZGl2IGNsYXNzPVwic2lkZWJhci1jb250YWluZXJcIj5cbiAgPGRpdiBjbGFzcz1cInNpZGViYXItdXNlci1wcm9maWxlLWJsb2NrXCI+XG4gICAgPGRpdiBjbGFzcz1cInNpZGViYXItdXNlci1wcm9maWxlLWxvZ29cIiAqbmdJZj1cIiFsb2FkaW5nVXNlclwiPnt7Y3VycmVudFVzZXI/Lm5hbWUgfCBhYmJyZXZpYXRlfX08L2Rpdj5cbiAgICA8ZGl2IGNsYXNzPVwic2lkZWJhci11c2VyLXByb2ZpbGUtaW5mb1wiPlxuICAgICAgPGRpdj5cbiAgICAgICAgPGRpdiBjbGFzcz1cInNpZGViYXItdXNlci1uYW1lXCIgKm5nSWY9XCIhbG9hZGluZ1VzZXJcIj57e2N1cnJlbnRVc2VyPy5uYW1lfX08L2Rpdj5cbiAgICAgICAgPGRpdiBjbGFzcz1cInNpZGViYXItdXNlci1lbWFpbFwiICpuZ0lmPVwiIWxvYWRpbmdVc2VyXCI+e3tjdXJyZW50VXNlcj8uZW1haWx9fTwvZGl2PlxuICAgICAgPC9kaXY+XG4gICAgPC9kaXY+XG4gIDwvZGl2PlxuICA8dWwgY2xhc3M9XCJzaWRlYmFyLWxpc3QtYmxvY2tcIj5cbiAgICA8bGkgW25nQ2xhc3NdPVwie1xuICAgICAgICAgICdzaWRlYmFyLWFwcC1oaWRkZW4nOiAhc2hvd1NpZGViYXJBcHBzXG4gICAgICAgIH1cIj5cbiAgICAgIDxpbnB1dCB0eXBlPVwidGV4dFwiIGNsYXNzPVwic2lkZWJhci1hcHAtaW5wdXRcIiBwbGFjZWhvbGRlcj1cIlNlYXJjaCBBcHBzXCIgWyhuZ01vZGVsKV09XCJmaWx0ZXJlZEFwcFwiIChuZ01vZGVsQ2hhbmdlKT1cInVwZGF0ZU1lbnVNb2R1bGVzKClcIj5cbiAgICA8L2xpPlxuICAgIDxsaSBjbGFzcz1cInNpZGViYXItYXBwLWxpc3RcIiBbbmdDbGFzc109XCJ7XG4gICAgICAgICAgJ3NpZGViYXItYXBwLWhpZGRlbic6ICFzaG93U2lkZWJhckFwcHNcbiAgICAgICAgfVwiPlxuICAgICAgPGEgKm5nRm9yPVwibGV0IGFwcCBvZiAgYXBwcyB8IGZpbHRlckJ5TmFtZTogZmlsdGVyZWRBcHBcIiBbaHJlZl09XCJhcHAuZGVmYXVsdEFjdGlvblwiIGNsYXNzPVwic2lkZWJhci1hcHAtbWVudS1idG5cIj5cbiAgICAgICAgPGRpdiBjbGFzcz1cInNpZGViYXItYXBwLW1lbnUtYnRuLWNvbnRlbnRcIj5cbiAgICAgICAgICA8aW1nIGFsdD1cIlwiIFtzcmNdPVwiYXBwLmljb25cIiB0aXRsZT1cInt7YXBwLmRpc3BsYXlOYW1lfX1cIj5cbiAgICAgICAgICA8ZGl2IGNsYXNzPVwiYXBwLW1lbnUtbmFtZVwiPnt7YXBwLmRpc3BsYXlOYW1lfX08L2Rpdj5cbiAgICAgICAgPC9kaXY+XG4gICAgICA8L2E+XG4gICAgPC9saT5cbiAgICA8bGkgKm5nRm9yPVwibGV0IHByb2ZpbGVNZW51IG9mIHByb2ZpbGVNZW51c1wiPlxuICAgICAgPGEgW2hyZWZdPVwicm9vdFVybCArIHByb2ZpbGVNZW51LmRlZmF1bHRBY3Rpb25cIj5cbiAgICAgICAgPGltZyBhbHQ9XCJcIiBbc3JjXT1cInByb2ZpbGVNZW51Lmljb25cIj4ge3twcm9maWxlTWVudS5uYW1lfX1cbiAgICAgIDwvYT5cbiAgICA8L2xpPlxuICAgIDxsaT5cbiAgICAgIDxhIFtocmVmXT1cInJvb3RVcmwgKyAnZGhpcy13ZWItY29tbW9ucy1zZWN1cml0eS9sb2dvdXQuYWN0aW9uJ1wiPlxuICAgICAgICA8aW1nIFtzcmNdPVwibG9nT3V0SWNvblwiPiBMb2cgT3V0XG4gICAgICA8L2E+XG4gICAgPC9saT5cbiAgPC91bD5cbjwvZGl2PmAsXG4gIHN0eWxlczogW2Auc2lkZWJhci11c2VyLXByb2ZpbGUtYmxvY2t7dGV4dC1hbGlnbjpsZWZ0O2JhY2tncm91bmQtY29sb3I6I2VlZTtoZWlnaHQ6NTBweDtwYWRkaW5nOjVweDtkaXNwbGF5OmZsZXh9LnNpZGViYXItdXNlci1wcm9maWxlLWxvZ297aGVpZ2h0OjQwcHg7ZGlzcGxheTpmbGV4O2FsaWduLWl0ZW1zOmNlbnRlcjtqdXN0aWZ5LWNvbnRlbnQ6Y2VudGVyO2ZvbnQtc2l6ZToxNHB4O2ZvbnQtd2VpZ2h0OjUwMDtjb2xvcjojOWU5ZTllO3dpZHRoOjQwcHg7Ym9yZGVyLXJhZGl1czoyNXB4O3RleHQtYWxpZ246Y2VudGVyO2JhY2tncm91bmQtY29sb3I6I2RkZH0uc2lkZWJhci11c2VyLXByb2ZpbGUtaW5mb3tkaXNwbGF5OmZsZXg7cGFkZGluZy1sZWZ0OjEwcHg7YWxpZ24taXRlbXM6Y2VudGVyfS5zaWRlYmFyLWxpc3QtYmxvY2t7bGlzdC1zdHlsZS10eXBlOm5vbmU7bWFyZ2luOjA7cGFkZGluZzowO2Rpc3BsYXk6YmxvY2t9LnNpZGViYXItaGlkZGVue2Rpc3BsYXk6bm9uZSFpbXBvcnRhbnR9LnNpZGViYXItYXBwLWlucHV0e2JvcmRlci1zdHlsZTpub25lO2JvcmRlci1ib3R0b206MXB4IHNvbGlkICNlZWU7Y29sb3I6Izc3Nzt3aWR0aDoxMDAlO2ZvbnQtc2l6ZToxMnB4O3BhZGRpbmc6NXB4IDdweH0uc2lkZWJhci1hcHAtaW5wdXQ6Zm9jdXN7b3V0bGluZTowfS5zaWRlYmFyLWxpc3QtYmxvY2sgbGkgYXt0ZXh0LWRlY29yYXRpb246bm9uZTtmb250LXNpemU6MTNweDtkaXNwbGF5OmJsb2NrO2NvbG9yOiMwMDA7Ym9yZGVyLWJvdHRvbToxcHggc29saWQgI2VlZTtwYWRkaW5nOjdweCAxMHB4fS5zaWRlYmFyLWxpc3QtYmxvY2sgbGkgYSBpbWd7aGVpZ2h0OjE1cHh9LnNpZGViYXItYXBwLWxpc3R7ZGlzcGxheTpmbGV4O292ZXJmbG93OmF1dG87aGVpZ2h0OjIwMHB4O2ZsZXgtd3JhcDp3cmFwfS5zaWRlYmFyLWFwcC1tZW51LWJ0bntkaXNwbGF5OmZsZXghaW1wb3J0YW50O2FsaWduLWl0ZW1zOmNlbnRlcjtqdXN0aWZ5LWNvbnRlbnQ6Y2VudGVyO21hcmdpbjo1cHg7dGV4dC1kZWNvcmF0aW9uOm5vbmU7Ym9yZGVyLXJhZGl1czozcHg7Ym9yZGVyOjFweCBzb2xpZCAjZWVlO3RyYW5zaXRpb246YWxsIC4ycyBlYXNlLWluLW91dDt3aWR0aDo4MHB4O2hlaWdodDo4MHB4fS5zaWRlYmFyLWFwcC1tZW51LWJ0bi1jb250ZW50e3RleHQtYWxpZ246Y2VudGVyfS5hcHAtbWVudS1uYW1le21hcmdpbi10b3A6NXB4O2ZvbnQtc2l6ZToxMXB4fS5zaWRlYmFyLXVzZXItbmFtZXtmb250LXNpemU6MTNweH0uc2lkZWJhci11c2VyLWVtYWlse2ZvbnQtc2l6ZToxMXB4O2NvbG9yOiM3Nzc7Zm9udC1zdHlsZTppdGFsaWN9YF1cbn0pXG5leHBvcnQgY2xhc3MgTWVudVNpZGVCYXJDb21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQge1xuICBASW5wdXQoKVxuICByb290VXJsOiBzdHJpbmc7XG4gIHNob3dQcm9maWxlOiBib29sZWFuO1xuICBjdXJyZW50VXNlcjogYW55O1xuICBsb2FkaW5nVXNlcjogYm9vbGVhbjtcbiAgcHJvZmlsZU1lbnVzOiBhbnlbXTtcbiAgYXBwczogYW55W107XG4gIG9yaWdpbmFsQXBwczogYW55W107XG4gIGxvYWRpbmdNb2R1bGVzOiBib29sZWFuO1xuICBmaWx0ZXJlZEFwcDogc3RyaW5nO1xuICBzaG93U2lkZWJhckFwcHM6IGJvb2xlYW47XG4gIGxvZ091dEljb246IHN0cmluZztcblxuICBjb25zdHJ1Y3Rvcihwcml2YXRlIG1lbnVTZXJ2aWNlOiBNZW51U2VydmljZSkge1xuICAgIHRoaXMuc2hvd1Byb2ZpbGUgPSBmYWxzZTtcbiAgICB0aGlzLnJvb3RVcmwgPSAnLi4vLi4vLi4vJztcbiAgICB0aGlzLmxvYWRpbmdVc2VyID0gdHJ1ZTtcbiAgICB0aGlzLmFwcHMgPSBbXTtcbiAgICB0aGlzLm9yaWdpbmFsQXBwcyA9IFtdO1xuICAgIHRoaXMubG9hZGluZ01vZHVsZXMgPSB0cnVlO1xuICAgIHRoaXMucHJvZmlsZU1lbnVzID0gUFJPRklMRV9NRU5VUztcbiAgICB0aGlzLmZpbHRlcmVkQXBwID0gJyc7XG4gICAgdGhpcy5zaG93U2lkZWJhckFwcHMgPSBmYWxzZTtcbiAgICB0aGlzLmxvZ091dEljb24gPSBMT0dfT1VUO1xuICB9XG5cbiAgbmdPbkluaXQoKSB7XG4gICAgdGhpcy5tZW51U2VydmljZS5nZXRVc2VySW5mbyh0aGlzLnJvb3RVcmwpLnN1YnNjcmliZSgocHJvZmlsZTogYW55KSA9PiB7XG4gICAgICBpZiAocHJvZmlsZSkge1xuICAgICAgICB0aGlzLmN1cnJlbnRVc2VyID0ge1xuICAgICAgICAgIG5hbWU6IHByb2ZpbGUuZGlzcGxheU5hbWUsXG4gICAgICAgICAgZW1haWw6IHByb2ZpbGUuZW1haWxcbiAgICAgICAgfTtcbiAgICAgIH1cblxuICAgICAgdGhpcy5sb2FkaW5nVXNlciA9IGZhbHNlO1xuICAgIH0pO1xuXG4gICAgdGhpcy5tZW51U2VydmljZVxuICAgICAgLmdldE1lbnVNb2R1bGVzKHRoaXMucm9vdFVybClcbiAgICAgIC5zdWJzY3JpYmUoKG1lbnVNb2R1bGVzOiBhbnkpID0+IHtcbiAgICAgICAgaWYgKG1lbnVNb2R1bGVzICE9PSBudWxsKSB7XG4gICAgICAgICAgdGhpcy5sb2FkaW5nTW9kdWxlcyA9IGZhbHNlO1xuICAgICAgICAgIHRoaXMub3JpZ2luYWxBcHBzID0gWy4uLm1lbnVNb2R1bGVzXTtcbiAgICAgICAgICB0aGlzLmFwcHMgPSB0aGlzLl9wcmVwYXJlTWVudU1vZHVsZXMoKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gIH1cblxuICBwcml2YXRlIF9wcmVwYXJlTWVudU1vZHVsZXMoKSB7XG4gICAgcmV0dXJuIHRoaXMuZmlsdGVyZWRBcHAgPT09ICcnXG4gICAgICA/IHRoaXMub3JpZ2luYWxBcHBzLmZpbHRlcigobWVudTogYW55KSA9PiB7XG4gICAgICAgICAgcmV0dXJuICFtZW51Lm9ubHlTaG93T25TZWFyY2g7XG4gICAgICAgIH0pXG4gICAgICA6IHRoaXMub3JpZ2luYWxBcHBzO1xuICB9XG5cbiAgdG9nZ2xlU2lkZWJhck1lbnVzKGUpIHtcbiAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgIHRoaXMuc2hvd1NpZGViYXJBcHBzID0gIXRoaXMuc2hvd1NpZGViYXJBcHBzO1xuICB9XG5cbiAgdXBkYXRlTWVudU1vZHVsZXMoKSB7XG4gICAgdGhpcy5hcHBzID0gdGhpcy5fcHJlcGFyZU1lbnVNb2R1bGVzKCk7XG4gIH1cbn1cbiJdfQ==