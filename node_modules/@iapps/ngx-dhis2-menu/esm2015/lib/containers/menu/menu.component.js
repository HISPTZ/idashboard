/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes} checked by tsc
 */
import { Component } from '@angular/core';
import { trigger, state, style, transition, animate } from '@angular/animations';
import { MenuService } from '../../services/menu.service';
import { SystemStateService } from '../../services/system-state.service';
import { MENU_BACKGROUND_COLORS } from '../../constants/menu-background-colors';
export class MenuComponent {
    /**
     * @param {?} menuService
     * @param {?} systemStatusService
     */
    constructor(menuService, systemStatusService) {
        this.menuService = menuService;
        this.systemStatusService = systemStatusService;
        this.rootUrl = '../../../';
        this.menuLoading = true;
        this.menuLoadingFail = false;
        this.loggedIn$ = this.systemStatusService.getLoginStatus();
        this.online = false;
        this.menuNotification = '';
        this.wasOffline = true;
        this.backgroundColor = '#ECECEC';
        this.showSidebar = false;
    }
    /**
     * @return {?}
     */
    ngOnInit() {
        this.systemStatusService.checkOnlineStatus().subscribe((onlineStatus) => {
            this.online = onlineStatus;
            if (this.online && this.wasOffline) {
                this.menuNotification = 'You are online';
                this.wasOffline = false;
                /**
                         * Hide notification status after sometimes
                         */
                setTimeout(() => {
                    this.menuNotification = '';
                }, 3000);
                /**
                         * Load system settings if failed
                         */
                if (this.menuLoadingFail) {
                    this.menuLoading = true;
                    this.getSystemSettings();
                }
            }
            else if (!this.online) {
                this.menuNotification = 'You are offline';
                this.wasOffline = true;
            }
        });
        this.getSystemSettings();
    }
    /**
     * @param {?} e
     * @return {?}
     */
    toggleSideBar(e) {
        e.stopPropagation();
        this.showSidebar = !this.showSidebar;
    }
    /**
     * @return {?}
     */
    getSystemSettings() {
        this.menuService.getSystemSettings(this.rootUrl).subscribe((settings) => {
            if (settings) {
                this.applicationTitle = settings['applicationTitle'];
                // get system current background style
                const /** @type {?} */ colorName = settings.hasOwnProperty('currentStyle')
                    ? settings['currentStyle'].split('/')[0]
                    : settings.hasOwnProperty('keyStyle')
                        ? settings['keyStyle'].split('/')[0]
                        : 'blue';
                this.backgroundColor =
                    MENU_BACKGROUND_COLORS[colorName];
                this.contextPath = settings.contextPath ? settings.contextPath + '/' : '';
            }
            this.menuLoading = false;
            this.menuLoadingFail = false;
        }, () => {
            this.menuLoading = false;
            this.menuLoadingFail = true;
        });
    }
}
MenuComponent.decorators = [
    { type: Component, args: [{
                selector: 'ngx-dhis2-menu',
                template: `<div class="menu-container">

  <!-- notification area -->
  <div class="menu-notification-area" *ngIf="menuNotification !== ''" [@open]>
    {{ menuNotification }}
  </div>
  <!-- end of notification area -->
  <!-- login form area -->
  <div class="login-form-container" *ngIf="!(loggedIn$ | async)">
    <app-login-form></app-login-form>
  </div>
  <!-- end of login form area -->

  <!--menu loading area-->
  <div class="menu-loader" *ngIf="menuLoading">
    <app-menu-loader></app-menu-loader>
  </div>
  <!--end of menu loading area-->

  <!--menu loading failed area-->
  <div class="menu-content" *ngIf="!menuLoading && menuLoadingFail" style="background-color: #eeeeee">
    &nbsp;
  </div>
  <!--end of menu loading failed area-->

  <!--menu content area-->
  <div class="menu-content" [style.background-color]="backgroundColor" *ngIf="!menuLoading && !menuLoadingFail">
    <!--menu left block-->
    <div class="menu-left-block">

      <!--menu brand area-->
      <div class="menu-brand">
        <a [href]="rootUrl + 'dhis-web-commons-about/redirect.action'">
          <img [src]="rootUrl + 'api/staticContent/logo_banner'" alt="">
        </a>
      </div>
      <!--end of menu brand area-->

      <!--menu title area-->
      <div class="menu-title-block">
        <a [href]="rootUrl + 'dhis-web-commons-about/redirect.action'" class="menu-title">
          {{applicationTitle}}
        </a>
      </div>
      <!--end of menu title area-->
    </div>
    <!--end of menu left block-->

    <!--menu right block-->
    <div class="menu-right-block">
      <div class="menu-notification-block">
        <app-menu-notification [rootUrl]="rootUrl"></app-menu-notification>
      </div>
      <!--menu search block-->
      <div class="menu-search-block">
        <app-menu-search></app-menu-search>
      </div>
      <!--end of menu search block-->

      <!--menu profile block-->
      <div class="menu-profile-block">
        <app-menu-profile [rootUrl]="rootUrl" [contextPath]="contextPath" [backgroundColor]="backgroundColor"></app-menu-profile>
      </div>
      <!--end of menu profile block-->

      <!--menu sidebar toggle button-->
      <div
        class="menu-toggle-button"
      >
        <a
          (click)="toggleSideBar($event)"
        >
          <svg
            class="menu-toggle-icon"
            viewBox="0 0 24 24"
          >
            <path d="M4 8h4V4H4v4zm6 12h4v-4h-4v4zm-6 0h4v-4H4v4zm0-6h4v-4H4v4zm6 0h4v-4h-4v4zm6-10v4h4V4h-4zm-6 4h4V4h-4v4zm6 6h4v-4h-4v4zm0 6h4v-4h-4v4z"></path>
          </svg>
        </a>
      </div>
      <!--end of menu sidebar toggle button-->

      <!--sidebar menu block-->
      <div class="sidebar-menu-nav" *ngIf="showSidebar">
        <app-menu-side-bar></app-menu-side-bar>
      </div>
      <!--end of sidebar menu block-->
      <div></div>
    </div>
    <!--end of menu right block-->
  </div>
  <!--end of menu content area-->
</div>
`,
                styles: [`.menu-container{position:fixed;left:0;top:0;right:0;z-index:1400;height:48px}.menu-loader{height:100%}.menu-content{display:flex;width:100%;height:100%;justify-content:space-between}.menu-left-block,.menu-right-block{display:flex}.menu-brand{width:155px;height:100%;display:flex;justify-content:center;align-items:center}.menu-brand>a>img{display:block;margin:auto;max-height:44px;max-width:155px}.menu-title-block{overflow:hidden;white-space:nowrap;color:#fff;align-items:center;justify-items:center;display:flex;padding-right:1rem}.menu-title{font-size:1rem;font-weight:700;color:#fff;text-decoration:none;text-overflow:ellipsis;min-width:1px;overflow:hidden;white-space:nowrap}.menu-search-block{height:100%}.login-form-container{position:fixed;z-index:1500;top:2px;left:20%;min-height:42px;border-color:#f0c36d;background-color:#f9edbe;border-radius:3px}.menu-notification-area{position:fixed;z-index:1500;top:7px;left:20%;height:auto;border-color:#f0c36d;background-color:#f9edbe;border-radius:3px;padding:5px;font-size:15px}.menu-toggle-button{display:none;flex-direction:row;justify-content:flex-end;padding-right:10px;padding-top:6px}.menu-toggle-icon{display:inline-block;height:35px;width:35px;fill:#fff}.sidebar-menu-nav{position:absolute;top:100%;width:400px;height:100vh;right:0;z-index:900;font-size:14px;text-align:left;list-style:none;background-color:#fff;-webkit-background-clip:padding-box;transition:width .5s cubic-bezier(.39,-.04,.2,1);background-clip:padding-box;box-shadow:0 6px 12px rgba(0,0,0,.175)}@media (max-width:400px){.sidebar-menu-nav{width:95%}}@media (max-width:500px){.login-form-container{top:50px;left:2%;width:96%;height:auto}.menu-notification-area{left:2%;right:2%;width:96%;height:auto}}@media (max-width:999px){.menu-profile-block,.menu-search-block,.menu-title-block{display:none}.menu-brand{justify-content:flex-start;margin-left:15px}.menu-toggle-button{display:flex}}.menu-notification-block{display:flex;align-items:center;height:100%;margin-right:30px}@media (min-width:1010px){.sidebar-menu-nav{display:none!important}}`],
                animations: [
                    trigger('open', [
                        state('in', style({
                            opacity: 1
                        })),
                        transition('void => *', [
                            style({
                                opacity: 0
                            }),
                            animate(700)
                        ]),
                        transition('* => void', [
                            animate(400),
                            style({
                                opacity: 0
                            })
                        ])
                    ])
                ]
            },] },
];
/** @nocollapse */
MenuComponent.ctorParameters = () => [
    { type: MenuService },
    { type: SystemStateService }
];
function MenuComponent_tsickle_Closure_declarations() {
    /** @type {?} */
    MenuComponent.prototype.rootUrl;
    /** @type {?} */
    MenuComponent.prototype.applicationTitle;
    /** @type {?} */
    MenuComponent.prototype.backgroundColor;
    /** @type {?} */
    MenuComponent.prototype.menuLoading;
    /** @type {?} */
    MenuComponent.prototype.menuLoadingFail;
    /** @type {?} */
    MenuComponent.prototype.loggedIn$;
    /** @type {?} */
    MenuComponent.prototype.online;
    /** @type {?} */
    MenuComponent.prototype.menuNotification;
    /** @type {?} */
    MenuComponent.prototype.wasOffline;
    /** @type {?} */
    MenuComponent.prototype.showSidebar;
    /** @type {?} */
    MenuComponent.prototype.contextPath;
    /** @type {?} */
    MenuComponent.prototype.menuService;
    /** @type {?} */
    MenuComponent.prototype.systemStatusService;
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWVudS5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AaWFwcHMvbmd4LWRoaXMyLW1lbnUvIiwic291cmNlcyI6WyJsaWIvY29udGFpbmVycy9tZW51L21lbnUuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7QUFBQSxPQUFPLEVBQUUsU0FBUyxFQUFVLE1BQU0sZUFBZSxDQUFDO0FBQ2xELE9BQU8sRUFDTCxPQUFPLEVBQ1AsS0FBSyxFQUNMLEtBQUssRUFDTCxVQUFVLEVBQ1YsT0FBTyxFQUNSLE1BQU0scUJBQXFCLENBQUM7QUFFN0IsT0FBTyxFQUFFLFdBQVcsRUFBRSxNQUFNLDZCQUE2QixDQUFDO0FBQzFELE9BQU8sRUFBRSxrQkFBa0IsRUFBRSxNQUFNLHFDQUFxQyxDQUFDO0FBQ3pFLE9BQU8sRUFBRSxzQkFBc0IsRUFBRSxNQUFNLHdDQUF3QyxDQUFDO0FBMEhoRixNQUFNOzs7OztJQWFKLFlBQW9CLFdBQXdCLEVBQ2xDO1FBRFUsZ0JBQVcsR0FBWCxXQUFXLENBQWE7UUFDbEMsd0JBQW1CLEdBQW5CLG1CQUFtQjtRQUMzQixJQUFJLENBQUMsT0FBTyxHQUFHLFdBQVcsQ0FBQztRQUMzQixJQUFJLENBQUMsV0FBVyxHQUFHLElBQUksQ0FBQztRQUN4QixJQUFJLENBQUMsZUFBZSxHQUFHLEtBQUssQ0FBQztRQUM3QixJQUFJLENBQUMsU0FBUyxHQUFHLElBQUksQ0FBQyxtQkFBbUIsQ0FBQyxjQUFjLEVBQUUsQ0FBQztRQUMzRCxJQUFJLENBQUMsTUFBTSxHQUFHLEtBQUssQ0FBQztRQUNwQixJQUFJLENBQUMsZ0JBQWdCLEdBQUcsRUFBRSxDQUFDO1FBQzNCLElBQUksQ0FBQyxVQUFVLEdBQUcsSUFBSSxDQUFDO1FBQ3ZCLElBQUksQ0FBQyxlQUFlLEdBQUcsU0FBUyxDQUFDO1FBQ2pDLElBQUksQ0FBQyxXQUFXLEdBQUcsS0FBSyxDQUFDO0tBQzFCOzs7O0lBRUQsUUFBUTtRQUNOLElBQUksQ0FBQyxtQkFB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dWhFQUF1aEUsQ0FBQztnQkFDamlFLFVBQVUsRUFBRTtvQkFDVixPQUFPLENBQUMsTUFBTSxFQUFFO3dCQUNkLEtBQUssQ0FDSCxJQUFJLEVBQ0osS0FBSyxDQUFDOzRCQUNKLE9BQU8sRUFBRSxDQUFDO3lCQUNYLENBQUMsQ0FDSDt3QkFDRCxVQUFVLENBQUMsV0FBVyxFQUFFOzRCQUN0QixLQUFLLENBQUM7Z0NBQ0osT0FBTyxFQUFFLENBQUM7NkJBQ1gsQ0FBQzs0QkFDRixPQUFPLENBQUMsR0FBRyxDQUFDO3lCQUNiLENBQUM7d0JBQ0YsVUFBVSxDQUFDLFdBQVcsRUFBRTs0QkFDdEIsT0FBTyxDQUFDLEdBQUcsQ0FBQzs0QkFDWixLQUFLLENBQUM7Z0NBQ0osT0FBTyxFQUFFLENBQUM7NkJBQ1gsQ0FBQzt5QkFDSCxDQUFDO3FCQUNILENBQUM7aUJBQ0g7YUFDRjs7OztZQTNIUSxXQUFXO1lBQ1gsa0JBQWtCIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ29tcG9uZW50LCBPbkluaXQgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7XG4gIHRyaWdnZXIsXG4gIHN0YXRlLFxuICBzdHlsZSxcbiAgdHJhbnNpdGlvbixcbiAgYW5pbWF0ZVxufSBmcm9tICdAYW5ndWxhci9hbmltYXRpb25zJztcbmltcG9ydCB7IE9ic2VydmFibGUgfSBmcm9tICdyeGpzJztcbmltcG9ydCB7IE1lbnVTZXJ2aWNlIH0gZnJvbSAnLi4vLi4vc2VydmljZXMvbWVudS5zZXJ2aWNlJztcbmltcG9ydCB7IFN5c3RlbVN0YXRlU2VydmljZSB9IGZyb20gJy4uLy4uL3NlcnZpY2VzL3N5c3RlbS1zdGF0ZS5zZXJ2aWNlJztcbmltcG9ydCB7IE1FTlVfQkFDS0dST1VORF9DT0xPUlMgfSBmcm9tICcuLi8uLi9jb25zdGFudHMvbWVudS1iYWNrZ3JvdW5kLWNvbG9ycyc7XG5cbkBDb21wb25lbnQoe1xuICBzZWxlY3RvcjogJ25neC1kaGlzMi1tZW51JyxcbiAgdGVtcGxhdGU6IGA8ZGl2IGNsYXNzPVwibWVudS1jb250YWluZXJcIj5cblxuICA8IS0tIG5vdGlmaWNhdGlvbiBhcmVhIC0tPlxuICA8ZGl2IGNsYXNzPVwibWVudS1ub3RpZmljYXRpb24tYXJlYVwiICpuZ0lmPVwibWVudU5vdGlmaWNhdGlvbiAhPT0gJydcIiBbQG9wZW5dPlxuICAgIHt7IG1lbnVOb3RpZmljYXRpb24gfX1cbiAgPC9kaXY+XG4gIDwhLS0gZW5kIG9mIG5vdGlmaWNhdGlvbiBhcmVhIC0tPlxuICA8IS0tIGxvZ2luIGZvcm0gYXJlYSAtLT5cbiAgPGRpdiBjbGFzcz1cImxvZ2luLWZvcm0tY29udGFpbmVyXCIgKm5nSWY9XCIhKGxvZ2dlZEluJCB8IGFzeW5jKVwiPlxuICAgIDxhcHAtbG9naW4tZm9ybT48L2FwcC1sb2dpbi1mb3JtPlxuICA8L2Rpdj5cbiAgPCEtLSBlbmQgb2YgbG9naW4gZm9ybSBhcmVhIC0tPlxuXG4gIDwhLS1tZW51IGxvYWRpbmcgYXJlYS0tPlxuICA8ZGl2IGNsYXNzPVwibWVudS1sb2FkZXJcIiAqbmdJZj1cIm1lbnVMb2FkaW5nXCI+XG4gICAgPGFwcC1tZW51LWxvYWRlcj48L2FwcC1tZW51LWxvYWRlcj5cbiAgPC9kaXY+XG4gIDwhLS1lbmQgb2YgbWVudSBsb2FkaW5nIGFyZWEtLT5cblxuICA8IS0tbWVudSBsb2FkaW5nIGZhaWxlZCBhcmVhLS0+XG4gIDxkaXYgY2xhc3M9XCJtZW51LWNvbnRlbnRcIiAqbmdJZj1cIiFtZW51TG9hZGluZyAmJiBtZW51TG9hZGluZ0ZhaWxcIiBzdHlsZT1cImJhY2tncm91bmQtY29sb3I6ICNlZWVlZWVcIj5cbiAgICAmbmJzcDtcbiAgPC9kaXY+XG4gIDwhLS1lbmQgb2YgbWVudSBsb2FkaW5nIGZhaWxlZCBhcmVhLS0+XG5cbiAgPCEtLW1lbnUgY29udGVudCBhcmVhLS0+XG4gIDxkaXYgY2xhc3M9XCJtZW51LWNvbnRlbnRcIiBbc3R5bGUuYmFja2dyb3VuZC1jb2xvcl09XCJiYWNrZ3JvdW5kQ29sb3JcIiAqbmdJZj1cIiFtZW51TG9hZGluZyAmJiAhbWVudUxvYWRpbmdGYWlsXCI+XG4gICAgPCEtLW1lbnUgbGVmdCBibG9jay0tPlxuICAgIDxkaXYgY2xhc3M9XCJtZW51LWxlZnQtYmxvY2tcIj5cblxuICAgICAgPCEtLW1lbnUgYnJhbmQgYXJlYS0tPlxuICAgICAgPGRpdiBjbGFzcz1cIm1lbnUtYnJhbmRcIj5cbiAgICAgICAgPGEgW2hyZWZdPVwicm9vdFVybCArICdkaGlzLXdlYi1jb21tb25zLWFib3V0L3JlZGlyZWN0LmFjdGlvbidcIj5cbiAgICAgICAgICA8aW1nIFtzcmNdPVwicm9vdFVybCArICdhcGkvc3RhdGljQ29udGVudC9sb2dvX2Jhbm5lcidcIiBhbHQ9XCJcIj5cbiAgICAgICAgPC9hPlxuICAgICAgPC9kaXY+XG4gICAgICA8IS0tZW5kIG9mIG1lbnUgYnJhbmQgYXJlYS0tPlxuXG4gICAgICA8IS0tbWVudSB0aXRsZSBhcmVhLS0+XG4gICAgICA8ZGl2IGNsYXNzPVwibWVudS10aXRsZS1ibG9ja1wiPlxuICAgICAgICA8YSBbaHJlZl09XCJyb290VXJsICsgJ2RoaXMtd2ViLWNvbW1vbnMtYWJvdXQvcmVkaXJlY3QuYWN0aW9uJ1wiIGNsYXNzPVwibWVudS10aXRsZVwiPlxuICAgICAgICAgIHt7YXBwbGljYXRpb25UaXRsZX19XG4gICAgICAgIDwvYT5cbiAgICAgIDwvZGl2PlxuICAgICAgPCEtLWVuZCBvZiBtZW51IHRpdGxlIGFyZWEtLT5cbiAgICA8L2Rpdj5cbiAgICA8IS0tZW5kIG9mIG1lbnUgbGVmdCBibG9jay0tPlxuXG4gICAgPCEtLW1lbnUgcmlnaHQgYmxvY2stLT5cbiAgICA8ZGl2IGNsYXNzPVwibWVudS1yaWdodC1ibG9ja1wiPlxuICAgICAgPGRpdiBjbGFzcz1cIm1lbnUtbm90aWZpY2F0aW9uLWJsb2NrXCI+XG4gICAgICAgIDxhcHAtbWVudS1ub3RpZmljYXRpb24gW3Jvb3RVcmxdPVwicm9vdFVybFwiPjwvYXBwLW1lbnUtbm90aWZpY2F0aW9uPlxuICAgICAgPC9kaXY+XG4gICAgICA8IS0tbWVudSBzZWFyY2ggYmxvY2stLT5cbiAgICAgIDxkaXYgY2xhc3M9XCJtZW51LXNlYXJjaC1ibG9ja1wiPlxuICAgICAgICA8YXBwLW1lbnUtc2VhcmNoPjwvYXBwLW1lbnUtc2VhcmNoPlxuICAgICAgPC9kaXY+XG4gICAgICA8IS0tZW5kIG9mIG1lbnUgc2VhcmNoIGJsb2NrLS0+XG5cbiAgICAgIDwhLS1tZW51IHByb2ZpbGUgYmxvY2stLT5cbiAgICAgIDxkaXYgY2xhc3M9XCJtZW51LXByb2ZpbGUtYmxvY2tcIj5cbiAgICAgICAgPGFwcC1tZW51LXByb2ZpbGUgW3Jvb3RVcmxdPVwicm9vdFVybFwiIFtjb250ZXh0UGF0aF09XCJjb250ZXh0UGF0aFwiIFtiYWNrZ3JvdW5kQ29sb3JdPVwiYmFja2dyb3VuZENvbG9yXCI+PC9hcHAtbWVudS1wcm9maWxlPlxuICAgICAgPC9kaXY+XG4gICAgICA8IS0tZW5kIG9mIG1lbnUgcHJvZmlsZSBibG9jay0tPlxuXG4gICAgICA8IS0tbWVudSBzaWRlYmFyIHRvZ2dsZSBidXR0b24tLT5cbiAgICAgIDxkaXZcbiAgICAgICAgY2xhc3M9XCJtZW51LXRvZ2dsZS1idXR0b25cIlxuICAgICAgPlxuICAgICAgICA8YVxuICAgICAgICAgIChjbGljayk9XCJ0b2dnbGVTaWRlQmFyKCRldmVudClcIlxuICAgICAgICA+XG4gICAgICAgICAgPHN2Z1xuICAgICAgICAgICAgY2xhc3M9XCJtZW51LXRvZ2dsZS1pY29uXCJcbiAgICAgICAgICAgIHZpZXdCb3g9XCIwIDAgMjQgMjRcIlxuICAgICAgICAgID5cbiAgICAgICAgICAgIDxwYXRoIGQ9XCJNNCA4aDRWNEg0djR6bTYgMTJoNHYtNGgtNHY0em0tNiAwaDR2LTRINHY0em0wLTZoNHYtNEg0djR6bTYgMGg0di00aC00djR6bTYtMTB2NGg0VjRoLTR6bS02IDRoNFY0aC00djR6bTYgNmg0di00aC00djR6bTAgNmg0di00aC00djR6XCI+PC9wYXRoPlxuICAgICAgICAgIDwvc3ZnPlxuICAgICAgICA8L2E+XG4gICAgICA8L2Rpdj5cbiAgICAgIDwhLS1lbmQgb2YgbWVudSBzaWRlYmFyIHRvZ2dsZSBidXR0b24tLT5cblxuICAgICAgPCEtLXNpZGViYXIgbWVudSBibG9jay0tPlxuICAgICAgPGRpdiBjbGFzcz1cInNpZGViYXItbWVudS1uYXZcIiAqbmdJZj1cInNob3dTaWRlYmFyXCI+XG4gICAgICAgIDxhcHAtbWVudS1zaWRlLWJhcj48L2FwcC1tZW51LXNpZGUtYmFyPlxuICAgICAgPC9kaXY+XG4gICAgICA8IS0tZW5kIG9mIHNpZGViYXIgbWVudSBibG9jay0tPlxuICAgICAgPGRpdj48L2Rpdj5cbiAgICA8L2Rpdj5cbiAgICA8IS0tZW5kIG9mIG1lbnUgcmlnaHQgYmxvY2stLT5cbiAgPC9kaXY+XG4gIDwhLS1lbmQgb2YgbWVudSBjb250ZW50IGFyZWEtLT5cbjwvZGl2PlxuYCxcbiAgc3R5bGVzOiBbYC5tZW51LWNvbnRhaW5lcntwb3NpdGlvbjpmaXhlZDtsZWZ0OjA7dG9wOjA7cmlnaHQ6MDt6LWluZGV4OjE0MDA7aGVpZ2h0OjQ4cHh9Lm1lbnUtbG9hZGVye2hlaWdodDoxMDAlfS5tZW51LWNvbnRlbnR7ZGlzcGxheTpmbGV4O3dpZHRoOjEwMCU7aGVpZ2h0OjEwMCU7anVzdGlmeS1jb250ZW50OnNwYWNlLWJldHdlZW59Lm1lbnUtbGVmdC1ibG9jaywubWVudS1yaWdodC1ibG9ja3tkaXNwbGF5OmZsZXh9Lm1lbnUtYnJhbmR7d2lkdGg6MTU1cHg7aGVpZ2h0OjEwMCU7ZGlzcGxheTpmbGV4O2p1c3RpZnktY29udGVudDpjZW50ZXI7YWxpZ24taXRlbXM6Y2VudGVyfS5tZW51LWJyYW5kPmE+aW1ne2Rpc3BsYXk6YmxvY2s7bWFyZ2luOmF1dG87bWF4LWhlaWdodDo0NHB4O21heC13aWR0aDoxNTVweH0ubWVudS10aXRsZS1ibG9ja3tvdmVyZmxvdzpoaWRkZW47d2hpdGUtc3BhY2U6bm93cmFwO2NvbG9yOiNmZmY7YWxpZ24taXRlbXM6Y2VudGVyO2p1c3RpZnktaXRlbXM6Y2VudGVyO2Rpc3BsYXk6ZmxleDtwYWRkaW5nLXJpZ2h0OjFyZW19Lm1lbnUtdGl0bGV7Zm9udC1zaXplOjFyZW07Zm9udC13ZWlnaHQ6NzAwO2NvbG9yOiNmZmY7dGV4dC1kZWNvcmF0aW9uOm5vbmU7dGV4dC1vdmVyZmxvdzplbGxpcHNpczttaW4td2lkdGg6MXB4O292ZXJmbG93OmhpZGRlbjt3aGl0ZS1zcGFjZTpub3dyYXB9Lm1lbnUtc2VhcmNoLWJsb2Nre2hlaWdodDoxMDAlfS5sb2dpbi1mb3JtLWNvbnRhaW5lcntwb3NpdGlvbjpmaXhlZDt6LWluZGV4OjE1MDA7dG9wOjJweDtsZWZ0OjIwJTttaW4taGVpZ2h0OjQycHg7Ym9yZGVyLWNvbG9yOiNmMGMzNmQ7YmFja2dyb3VuZC1jb2xvcjojZjllZGJlO2JvcmRlci1yYWRpdXM6M3B4fS5tZW51LW5vdGlmaWNhdGlvbi1hcmVhe3Bvc2l0aW9uOmZpeGVkO3otaW5kZXg6MTUwMDt0b3A6N3B4O2xlZnQ6MjAlO2hlaWdodDphdXRvO2JvcmRlci1jb2xvcjojZjBjMzZkO2JhY2tncm91bmQtY29sb3I6I2Y5ZWRiZTtib3JkZXItcmFkaXVzOjNweDtwYWRkaW5nOjVweDtmb250LXNpemU6MTVweH0ubWVudS10b2dnbGUtYnV0dG9ue2Rpc3BsYXk6bm9uZTtmbGV4LWRpcmVjdGlvbjpyb3c7anVzdGlmeS1jb250ZW50OmZsZXgtZW5kO3BhZGRpbmctcmlnaHQ6MTBweDtwYWRkaW5nLXRvcDo2cHh9Lm1lbnUtdG9nZ2xlLWljb257ZGlzcGxheTppbmxpbmUtYmxvY2s7aGVpZ2h0OjM1cHg7d2lkdGg6MzVweDtmaWxsOiNmZmZ9LnNpZGViYXItbWVudS1uYXZ7cG9zaXRpb246YWJzb2x1dGU7dG9wOjEwMCU7d2lkdGg6NDAwcHg7aGVpZ2h0OjEwMHZoO3JpZ2h0OjA7ei1pbmRleDo5MDA7Zm9udC1zaXplOjE0cHg7dGV4dC1hbGlnbjpsZWZ0O2xpc3Qtc3R5bGU6bm9uZTtiYWNrZ3JvdW5kLWNvbG9yOiNmZmY7LXdlYmtpdC1iYWNrZ3JvdW5kLWNsaXA6cGFkZGluZy1ib3g7dHJhbnNpdGlvbjp3aWR0aCAuNXMgY3ViaWMtYmV6aWVyKC4zOSwtLjA0LC4yLDEpO2JhY2tncm91bmQtY2xpcDpwYWRkaW5nLWJveDtib3gtc2hhZG93OjAgNnB4IDEycHggcmdiYSgwLDAsMCwuMTc1KX1AbWVkaWEgKG1heC13aWR0aDo0MDBweCl7LnNpZGViYXItbWVudS1uYXZ7d2lkdGg6OTUlfX1AbWVkaWEgKG1heC13aWR0aDo1MDBweCl7LmxvZ2luLWZvcm0tY29udGFpbmVye3RvcDo1MHB4O2xlZnQ6MiU7d2lkdGg6OTYlO2hlaWdodDphdXRvfS5tZW51LW5vdGlmaWNhdGlvbi1hcmVhe2xlZnQ6MiU7cmlnaHQ6MiU7d2lkdGg6OTYlO2hlaWdodDphdXRvfX1AbWVkaWEgKG1heC13aWR0aDo5OTlweCl7Lm1lbnUtcHJvZmlsZS1ibG9jaywubWVudS1zZWFyY2gtYmxvY2ssLm1lbnUtdGl0bGUtYmxvY2t7ZGlzcGxheTpub25lfS5tZW51LWJyYW5ke2p1c3RpZnktY29udGVudDpmbGV4LXN0YXJ0O21hcmdpbi1sZWZ0OjE1cHh9Lm1lbnUtdG9nZ2xlLWJ1dHRvbntkaXNwbGF5OmZsZXh9fS5tZW51LW5vdGlmaWNhdGlvbi1ibG9ja3tkaXNwbGF5OmZsZXg7YWxpZ24taXRlbXM6Y2VudGVyO2hlaWdodDoxMDAlO21hcmdpbi1yaWdodDozMHB4fUBtZWRpYSAobWluLXdpZHRoOjEwMTBweCl7LnNpZGViYXItbWVudS1uYXZ7ZGlzcGxheTpub25lIWltcG9ydGFudH19YF0sXG4gIGFuaW1hdGlvbnM6IFtcbiAgICB0cmlnZ2VyKCdvcGVuJywgW1xuICAgICAgc3RhdGUoXG4gICAgICAgICdpbicsXG4gICAgICAgIHN0eWxlKHtcbiAgICAgICAgICBvcGFjaXR5OiAxXG4gICAgICAgIH0pXG4gICAgICApLFxuICAgICAgdHJhbnNpdGlvbigndm9pZCA9PiAqJywgW1xuICAgICAgICBzdHlsZSh7XG4gICAgICAgICAgb3BhY2l0eTogMFxuICAgICAgICB9KSxcbiAgICAgICAgYW5pbWF0ZSg3MDApXG4gICAgICBdKSxcbiAgICAgIHRyYW5zaXRpb24oJyogPT4gdm9pZCcsIFtcbiAgICAgICAgYW5pbWF0ZSg0MDApLFxuICAgICAgICBzdHlsZSh7XG4gICAgICAgICAgb3BhY2l0eTogMFxuICAgICAgICB9KVxuICAgICAgXSlcbiAgICBdKVxuICBdXG59KVxuZXhwb3J0IGNsYXNzIE1lbnVDb21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQge1xuICByb290VXJsOiBzdHJpbmc7XG4gIGFwcGxpY2F0aW9uVGl0bGU6IHN0cmluZztcbiAgYmFja2dyb3VuZENvbG9yOiBzdHJpbmc7XG4gIG1lbnVMb2FkaW5nOiBib29sZWFuO1xuICBtZW51TG9hZGluZ0ZhaWw6IGJvb2xlYW47XG4gIGxvZ2dlZEluJDogT2JzZXJ2YWJsZTxib29sZWFuPjtcbiAgb25saW5lOiBib29sZWFuO1xuICBtZW51Tm90aWZpY2F0aW9uOiBzdHJpbmc7XG4gIHdhc09mZmxpbmU6IGJvb2xlYW47XG4gIHNob3dTaWRlYmFyOiBib29sZWFuO1xuICBjb250ZXh0UGF0aDogc3RyaW5nO1xuXG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgbWVudVNlcnZpY2U6IE1lbnVTZXJ2aWNlLFxuICAgIHByaXZhdGUgc3lzdGVtU3RhdHVzU2VydmljZTogU3lzdGVtU3RhdGVTZXJ2aWNlKSB7XG4gICAgdGhpcy5yb290VXJsID0gJy4uLy4uLy4uLyc7XG4gICAgdGhpcy5tZW51TG9hZGluZyA9IHRydWU7XG4gICAgdGhpcy5tZW51TG9hZGluZ0ZhaWwgPSBmYWxzZTtcbiAgICB0aGlzLmxvZ2dlZEluJCA9IHRoaXMuc3lzdGVtU3RhdHVzU2VydmljZS5nZXRMb2dpblN0YXR1cygpO1xuICAgIHRoaXMub25saW5lID0gZmFsc2U7XG4gICAgdGhpcy5tZW51Tm90aWZpY2F0aW9uID0gJyc7XG4gICAgdGhpcy53YXNPZmZsaW5lID0gdHJ1ZTtcbiAgICB0aGlzLmJhY2tncm91bmRDb2xvciA9ICcjRUNFQ0VDJztcbiAgICB0aGlzLnNob3dTaWRlYmFyID0gZmFsc2U7XG4gIH1cblxuICBuZ09uSW5pdCgpIHtcbiAgICB0aGlzLnN5c3RlbVN0YXR1c1NlcnZpY2UuY2hlY2tPbmxpbmVTdGF0dXMoKS5zdWJzY3JpYmUoKG9ubGluZVN0YXR1cykgPT4ge1xuICAgICAgdGhpcy5vbmxpbmUgPSBvbmxpbmVTdGF0dXM7XG4gICAgICBpZiAodGhpcy5vbmxpbmUgJiYgdGhpcy53YXNPZmZsaW5lKSB7XG4gICAgICAgIHRoaXMubWVudU5vdGlmaWNhdGlvbiA9ICdZb3UgYXJlIG9ubGluZSc7XG4gICAgICAgIHRoaXMud2FzT2ZmbGluZSA9IGZhbHNlO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBIaWRlIG5vdGlmaWNhdGlvbiBzdGF0dXMgYWZ0ZXIgc29tZXRpbWVzXG4gICAgICAgICAqL1xuICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICB0aGlzLm1lbnVOb3RpZmljYXRpb24gPSAnJztcbiAgICAgICAgfSwgMzAwMCk7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIExvYWQgc3lzdGVtIHNldHRpbmdzIGlmIGZhaWxlZFxuICAgICAgICAgKi9cbiAgICAgICAgaWYgKHRoaXMubWVudUxvYWRpbmdGYWlsKSB7XG4gICAgICAgICAgdGhpcy5tZW51TG9hZGluZyA9IHRydWU7XG4gICAgICAgICAgdGhpcy5nZXRTeXN0ZW1TZXR0aW5ncygpO1xuICAgICAgICB9XG5cbiAgICAgIH0gZWxzZSBpZiAoIXRoaXMub25saW5lKSB7XG4gICAgICAgIHRoaXMubWVudU5vdGlmaWNhdGlvbiA9ICdZb3UgYXJlIG9mZmxpbmUnO1xuICAgICAgICB0aGlzLndhc09mZmxpbmUgPSB0cnVlO1xuICAgICAgfVxuICAgIH0pO1xuICAgIHRoaXMuZ2V0U3lzdGVtU2V0dGluZ3MoKTtcbiAgfVxuXG4gIHRvZ2dsZVNpZGVCYXIoZSkge1xuICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgdGhpcy5zaG93U2lkZWJhciA9ICF0aGlzLnNob3dTaWRlYmFyO1xuICB9XG5cbiAgZ2V0U3lzdGVtU2V0dGluZ3MoKSB7XG4gICAgdGhpcy5tZW51U2VydmljZS5nZXRTeXN0ZW1TZXR0aW5ncyh0aGlzLnJvb3RVcmwpLnN1YnNjcmliZShcbiAgICAgIChzZXR0aW5nczogYW55KSA9PiB7XG4gICAgICAgIGlmIChzZXR0aW5ncykge1xuICAgICAgICAgIHRoaXMuYXBwbGljYXRpb25UaXRsZSA9IHNldHRpbmdzWydhcHBsaWNhdGlvblRpdGxlJ107XG5cbiAgICAgICAgICAvLyBnZXQgc3lzdGVtIGN1cnJlbnQgYmFja2dyb3VuZCBzdHlsZVxuICAgICAgICAgIGNvbnN0IGNvbG9yTmFtZSA9IHNldHRpbmdzLmhhc093blByb3BlcnR5KCdjdXJyZW50U3R5bGUnKVxuICAgICAgICAgICAgPyBzZXR0aW5nc1snY3VycmVudFN0eWxlJ10uc3BsaXQoJy8nKVswXVxuICAgICAgICAgICAgOiBzZXR0aW5ncy5oYXNPd25Qcm9wZXJ0eSgna2V5U3R5bGUnKVxuICAgICAgICAgICAgICA/IHNldHRpbmdzWydrZXlTdHlsZSddLnNwbGl0KCcvJylbMF1cbiAgICAgICAgICAgICAgOiAnYmx1ZSc7XG4gICAgICAgICAgdGhpcy5iYWNrZ3JvdW5kQ29sb3IgPVxuICAgICAgICAgICAgTUVOVV9CQUNLR1JPVU5EX0NPTE9SU1tjb2xvck5hbWVdO1xuXG4gICAgICAgICAgdGhpcy5jb250ZXh0UGF0aCA9IHNldHRpbmdzLmNvbnRleHRQYXRoID8gc2V0dGluZ3MuY29udGV4dFBhdGggKyAnLycgOiAnJztcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm1lbnVMb2FkaW5nID0gZmFsc2U7XG4gICAgICAgIHRoaXMubWVudUxvYWRpbmdGYWlsID0gZmFsc2U7XG4gICAgICB9LFxuICAgICAgKCkgPT4ge1xuICAgICAgICB0aGlzLm1lbnVMb2FkaW5nID0gZmFsc2U7XG4gICAgICAgIHRoaXMubWVudUxvYWRpbmdGYWlsID0gdHJ1ZTtcbiAgICAgIH1cbiAgICApO1xuICB9XG59XG4iXX0=